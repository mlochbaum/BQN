# BQN hosted in dzaima/BQN
# Result is a function that executes BQN code.

âŸ¨src,needâŸ© â† â€¢Import "src/pr.bqn"
âŸ¨DRunâŸ©     â†      â€¢Import "dc.bqn"
âŸ¨DCompileâŸ© â† need â€¢Import "dc.bqn"
glyphs â† âˆ¾ gl â† â€¢Import "src/glyphs.bqn"

GroupLen â† {(ğ•¨âŒˆâ‰ )âŠ¸â†‘0â€¢FillFnâ‰ Â¨âŠ”ğ•©}
extra â† âŸ¨ â€¢Type, â€¢FillFn, â‹†â¼, GroupLen, âˆ¾âŠ”âˆ˜âŠ¢, â€¢_fillBy_ âŸ©
provide â† { gâ†ğ•©âˆŠglyphs â‹„ (â‹â‹g)âŠextraâˆ¾â€¢BQNÂ¨g/ğ•© } âˆ¾need

rtâ€¿SetPrims â† â€¢COMP âŸ¨provide,(â€¢BQN"â€¢"âŠ¸âˆ¾)Â¨âŸ© DCompile src
PrimInd â† rtâŠ¸âŠâŒ¾<
Decompose â† ((â‰ glyphs)>PrimInd)â—¶âŸ¨â€¢Decompose,0âŠ¸â‰âŸ©
SetPrims âŸ¨ Decompose, PrimInd âŸ©

sys â† {ğ•©âŠËœğ•¨âŠ¸âŠ}Ëâ‰>âŸ¨
  "bqn"â€¿{BQNğ•©}
  "type"â€¿â€¢Type
  "glyph"â€¿(glyphsâŠ‘ËœPrimInd)
  "decompose"â€¿Decompose
âŸ©
BQN â† âŸ¨rt,SysâŸ©âŠ¸DRun
