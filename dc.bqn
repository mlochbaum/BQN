#! ./dzref

# dzaima/BQN block headers are a little different from the version used
# in the Javascript implementation:
# - Types are f/m/d instead of 0/1/2
# - dzaima/BQN uses variable names instead of counts (but we make the
#   names up anyway, except for special names).

compile â† âŸ¨â€¢pathâˆ¾"src/c.bqn","Compile"âŸ© â€¢EX â€¢pathâˆ¾"dzref"

primsâ†âŸ¨
  +,-,Ã—,Ã·,â‹†,âˆš,âŒŠ,âŒˆ,|,Â¬,âˆ§,âˆ¨,<,>,â‰ ,=,â‰¤,â‰¥,â‰¡,â‰¢,âŠ£,âŠ¢,â¥Š,âˆ¾,â‰,â†‘,â†“,â†•,âŒ½,â‰,/,â‹,â’,âŠ,âŠ‘,âŠ,âŠ’,âˆŠ,â·,âŠ”,!
  Ë™,Ëœ,Ë˜,Â¨,âŒœ,â¼,Â´,Ë,`
  âˆ˜,â—‹,âŠ¸,âŸœ,âŒ¾,âŠ˜,â—¶,â‰,âš‡,âŸ
âŸ©
specialâ†<Ë˜âˆ˜â€¿2â¥Š"ğ•¤ğ•©ğ•¨ğ•£ğ•—ğ•˜"
DRunâ†{
  âŸ¨bc,o,blkâŸ© â† prims Compile ğ•©
  blk â†© {
    âŸ¨t,i,l,nâŸ©â†ğ•©
    sâ†(3Ã—i)â†“(tâŠ‘3â€¿5â€¿6)â†‘special
    âŸ¨tâŠ‘"fmd",i,l,sâˆ¾â¥ŠÂ¨'a'+â†•n-â‰ sâŸ©
  }Â¨blk
  â€¢COMP âŸ¨bc,o,âŸ¨âŸ©,blkâŸ©
}
