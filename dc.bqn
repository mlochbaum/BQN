#! /usr/bin/env dbqn

# dzaima/BQN block headers have a different format to account for
# multiple bodies, and use variable names instead of counts.
# Rearrange and make up some names so the bytecode can be run.

compile â† â€¢Import â€¢pathâˆ¾"src/c.bqn"
prims â† (â€¢Import â€¢pathâˆ¾"dzref"){ğ”½} "âŸ¨
  +,-,Ã—,Ã·,â‹†,âˆš,âŒŠ,âŒˆ,|,Â¬,âˆ§,âˆ¨,<,>,â‰ ,=,â‰¤,â‰¥,â‰¡,â‰¢,âŠ£,âŠ¢,â¥Š,âˆ¾,â‰,â†‘,â†“,â†•,Â«,Â»,âŒ½,â‰,/,â‹,â’,âŠ,âŠ‘,âŠ,âŠ’,âˆŠ,â·,âŠ”,!
  Ë™,Ëœ,Ë˜,Â¨,âŒœ,â¼,Â´,Ë,`
  âˆ˜,â—‹,âŠ¸,âŸœ,âŒ¾,âŠ˜,â—¶,â‰,âš‡,âŸ
âŸ©"

specialâ†<Ë˜âˆ˜â€¿2â¥Š"ğ•¤ğ•©ğ•¨ğ•£ğ•—ğ•˜"
DCompileâ‡{
  âŸ¨bc,o,fblkâŸ© â† prims Compile ğ•©
  blkâ€¿bdy â† <Ë˜â‰>(â†•â‰ fblk){
    âŸ¨t,i,l,nâŸ©â†ğ•©
    sâ†(3Ã—i)â†“(tâŠ‘3â€¿5â€¿6)â†‘special
    âŸ¨âŸ¨t,i,ğ•¨,ğ•¨âŸ© â‹„ âŸ¨l, sâˆ¾â¥ŠÂ¨'a'+â†•n-â‰ sâŸ©âŸ©
  }Â¨fblk
  âŸ¨bc,o,blk,bdyâŸ©
}
DRunâ‡â€¢COMPâˆ˜DCompile
