lfâ†'
'
{
  F0â†ğ”½
  PadV â† {
    ls â† Â¯1â†“â‰¢ğ•©
    p â† â¥Š +â‰Â¯1â€¿âˆÂ´ Ã—âŒœËœ`âŒ¾âŒ½ (-1âŒˆls)â†‘Â¨1
    p â†© 0âŒ¾(Â¯1âŠ¸âŠ‘) p
    Pad â† {iâ†/1+ğ•¨ â‹„ (Â¯1Â¨âŒ¾((Â¬âˆŠi)âŠ¸/)i) âŠ ğ•©âˆ¾(Â¯1âŠ‘â‰¢ğ•©)â¥Š" "}
    p (âŠ‘0âˆŠls)â—¶âŸ¨Pad,+Â´âŠ¸â†‘âŸ© ((Ã—Â´ls)âˆ¾Â¯1âŠ‘â‰¢ğ•©) â¥Š ğ•©
  }âŸ(2 < =)
  PadH â† {
    (ğ•¨/" ") (âˆ¾â‰1âˆ¾â‰1âŠ£) ğ•©
  }
  Pad â† PadHâŸœPadV
  Enf0 â† { â‰"âŸ¨"âˆ¾(Â¯1â†“1â†“âŠğ•©)âˆ¾"âŸ©" }
  Enframe â† {(1â‰ ğ•¨)âˆ¨(1â‰ â‰ ğ•©)âˆ¨âŠ‘2âˆŠ+`-Ë"âŸ¨âŸ©"=âŒœâŠğ•©}â—¶Enf0â€¿{
    l â† Â¯1 âŠ‘ â‰¢ğ•©
    âˆ¾ âŸ¨ # "â”¼â•’â•›â•ª"
      1â€¿lâ†‘âˆ¾âŸ¨"â”Œ",(5âŠ¸<)â—¶âŸ¨â¥Š"Â·â”€"âŠËœ1âŒŠâŠ¢,F0âŸ©ğ•¨âŸ©
      ((4âŒŠ0âŒˆğ•¨-1)âŠ‘"Â·â•µâ•â”†â”Š")âŒ¾âŠ‘ ğ•©
      (1âˆ¾-l)â†‘"â”˜"
    âŸ©
  }
  FmtEmpty â† (0â€¿0â‰¢â‰¢)â—¶("â”Œâ”"â‰"â””â”˜")â€¿(((2â‰ =)âˆ¨0=â‰ )â—¶{
    'â”'âŒ¾(0â€¿Â¯1âŠ¸âŠ‘) 2 Enframe 1 PadH " "Â¨ğ•©
  }â€¿{
    â‰"âŸ¨âŸ©"âˆ¾Ëœ(1<â‰ )â—¶âŸ¨"",'â¥Š'âŒ¾(Â¯1âŠ¸âŠ‘)Â·âˆ¾Â·âˆ¾âŸœ"â€¿"Â¨F0Â¨âŸ©â‰¢ğ•©
  })
  PaddingJoin â† {1 PaddingJoin ğ•©}âŠ˜{
    s â† â‰¢Â¨ ğ•©
    w â† (0<=)â—¶âŸ¨â¥Š,âŒˆËâŸ(=-1Ëœ)âŸ©1âŠ‘Â¨s
    h â† âŒˆËâ‰1âŸ(0<=) âŠ‘Â¨s
    âˆ¾â‰2 â‰âŸ(0âŒˆ2-=) (h âˆ¾âŒœ ğ•¨Ã—wÂ¬(-ğ•¨Ã—â‰ w)â†‘1) â†‘Â¨ ğ•©
  }
  FmtMixed â† {
    (=ğ•©) Enframe 2 Pad ğ•¨ PaddingJoin FÂ¨ğ•©
  }
  F â† (2âŒŠâ‰¡)â—¶(â‰â‰¤âŸœâˆâ—¶âŸ¨"'"âŠ¸(âˆ¾âˆ¾âŠ£),F0âŸ©)â€¿{
    num â† ğ•©â‰¤âˆ â‹„ r â† =ğ•©
    ((â‰ (0âŠ¸<+â‰¤)+Â´)â¥Šnum)â—¶{
      # All characters
      k â† âˆâŸ(0âŠ¸=) -â‰  c â† Â¯1â†“â‰¢ğ•©
      q â† '"'
      ğ•© â†© (1+q=âŠ¢)âŠ¸/âŸ(k=âˆ) ğ•©
      (r Enframe 1 PadH PadV)âŸ(1â‰ r) â‰ (câ†‘q) âˆ¾â‰k ğ•© âˆ¾â‰k âŒ½âŒ¾â¥Šcâ†‘q
    }â€¿{
      # Not homogeneous, or empty
      (âˆ¨Â´0=â‰¢)â—¶FmtMixedâ€¿FmtEmpty ğ•©
    }â€¿{
      # All numbers
      Â¯1 FmtMixed ğ•©
    } ğ•©
  }â€¿FmtMixed
  Â¯1â†“â¥Š âˆ¾âŸœlfË˜ F ğ•©
}
