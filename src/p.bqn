# Plot

width â† 384
pad   â† 2â¥Š10

opts_type â† @
InitPlot â† {ğ•¤â‹„ opts_type â†© "line" }
SetPlot  â† {ğ•¤â‹„ opts_type â†© ğ•© }

pa â† At "class=Paren|stroke=currentColor|stroke-width=1"
pg â† At "class=red|style=fill:none|stroke-width=1"
pc â† At "class=red|r=4"
rc â† At "class=code|stroke-width=1|rx=5"
gr â† "g" At "font-family=BQN,monospace|font-size=18px"
Path â† "path" Elt âŠ£âˆ¾"d"â‹ˆâŠ¢

Pair â† {
  "â€¢Plot: ğ•¨ and ğ•© must consist of rows of numbers" ! ğ•¨ âŠ¢âŠ˜âˆ§â—‹((1â‰¤=)â—¶âŸ¨0,âˆ§Â´âˆ˜â¥Š@âŠ¸>âŸ©) ğ•©
  "â€¢Plot: ğ•¨ and ğ•© must have the same length" ! ğ•¨ 1âŠ˜(â‰¡â—‹(Â¯1âŠ‘â‰¢)) ğ•©
  â¥Š ğ•¨ (< (â†•Â¯1âŠ‘â‰¢)âŠ˜âŠ£ â‹ˆ âŠ¢)â‰1 ğ•©
}
PairRec â† {
  d â† ğ•¨â‰â—‹â‰¡ğ•©
  ğ•¨ (2â‰¤âŒŠÂ´d)â—¶âŸ¨PairâŠ£"â€¢Plot: invalid depth mixing"!Â·âˆ§Â´1=dË™, âˆ¾âˆ˜â¥Šğ•ŠÂ¨âŸ© ğ•©
}
Plot â† {
  xy â† 1e300 (âŠ£-âŠ¸âŒˆâŒŠ) â‰> ğ•¨ PairRec ğ•©   # organize and clip
  pts â† <âˆ˜âˆ¾Ë˜ xy
  AB â† {eâ†(Ã·5e15)(âŠ£Ã—âŒˆÂ´)|ğ•©â‹„(âŒŠâ‰âŒˆ)ËâŒ¾(-âŸœ0â€¿e)ğ•©} # ensure 0 < window size
  win â† -Ëœ`Â¨ bounds â† (AB âŒŠÂ´â‰âŒˆÂ´)Â¨ pts # min and range; min and max
  ar â† 1âŸ((Ã·4)âŠ¸>âˆ¨1.5âŠ¸<) Ã·ËœÂ´ 1âŠ‘Â¨win    # heightÃ·width
  dim â† width (âŠ£â‰Ã—) ar
  Scale â† ({Â¬ğ•}âŒ¾(1âŠ¸âŠ‘) {ğ•©Ã·Ëœğ•¨-ËœâŠ¢}Â´Â¨ win) {ğ•ğ•©}Â¨ âŠ¢
  line â† (/â‰ Â¨âŠxy) âŠ” FmtNum â‰> dimÃ—Scale pts
  draw â† ("line"â€¿"scatter"âŠ¸âŠâŒ¾<opts_type) âŠ‘ âŸ¨
    (pg Path {'M'âŒ¾âŠ‘ âˆ¾â¥Š "L "âˆ¾Â¨â‰1ğ•©})Â¨
    ("circle"Elt pcâˆ¾"cx"â€¿"cy"â‰Ë˜âŠ¢)Â¨ <Ë˜âˆ˜âˆ¾
  âŸ©
  ((-pad)âˆ¾dim+2Ã—pad) SVG gr Enc âˆ¾â¥ŠÂ¨ âŸ¨
    <"rect" Elt rcâˆ¾(Pos-padÃ·2)âˆ¾"width"â€¿"height"â‰Ë˜FmtNum dim+pad
    paâŠ¸PathÂ¨ ((0âŠ¸â‰¤âˆ§â‰¤âŸœ1)/Â·<âˆ˜âˆ¾Ë˜("M "âŠ¸âˆ¾Ë˜"VH")âˆ¾Â¨Â·FmtNum dim(Ã—âˆ¾Ë˜âŒ½âˆ˜âŠ£)(=âŒœËœâ†•2)âŠ¸Ã—) Scale 0
    Draw line
  âŸ©
}
Plotâ€¿InitPlotâ€¿SetPlot
