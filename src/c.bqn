lfâ†@+10
charSetâ€¿cglâ†(âˆ¾ â‰â—‹< â‰ Â¨)âŸ¨
  "+-Ã—Ã·â‹†âˆšâŒŠâŒˆ|Â¬âˆ§âˆ¨<>â‰ =â‰¤â‰¥â‰¡â‰¢âŠ£âŠ¢â¥Šâˆ¾â‰â†‘â†“â†•Â«Â»âŒ½â‰/â‹â’âŠâŠ‘âŠâŠ’âˆŠâ·âŠ”!" # Function
  "Ë™ËœË˜Â¨âŒœâ¼Â´Ë`"           # Modifier
  "âˆ˜â—‹âŠ¸âŸœâŒ¾âŠ˜â—¶â‰âš‡âŸ"          # Composition
  lfâˆ¾"â‹„,"               # Separator
  "â†â†©â†’"                 # Gets
  "(){}âŸ¨âŸ©"              # Bracket
  "â€¿"                   # Ligature
  "Â·"                   # nOthing
  # Use last character in case of UTF-16 (like dzaima/BQN)
  Â¯1âŠË˜10â€¿âˆ˜â¥Š"ğ•Šğ•ğ•ğ”½ğ”¾ğ•¤ğ•©ğ•¨ğ•—ğ•˜" # Input (ğ•£ pending; â„ not allowed)
  '0'+â†•10               # Digit
  "Ï€âˆÂ¯."                # Numeric
  "_"âˆ¾Ëœâ¥Š"aA"+âŒœâ†•naâ†26    # Alphabetic
  (Â¯1â†“"ğ•¨")âˆ¾" "âˆ¾@+9      # Whitespace (or special name prefix in UTF-16)
  "#'""@"               # Preprocessed characters
âŸ©
ErrUnknownCharsâ†{
  âŸ¨"Unknown character","s"/Ëœ1<â‰ ğ•©,": ",ğ•©âŸ©âˆ¾âŠ¸!0
}
CharCodeâ†charSet{
  Chk â† âŠ¢âŠ£ErrUnknownCharsâˆ˜(â‰ /âŠ£)âŸâ‰¢âŸœ(âŠâŸœğ•—)
  gâ†â‹ğ•— â‹„ âŠ¢ Chk gâŠËœ1-Ëœ1âŒˆ(gâŠğ•—)â‹âŠ¢
}
bFâ€¿bMâ€¿bCâ€¿bSâ€¿bGâ€¿bBâ€¿bLâ€¿bOâ€¿bIâ€¿bDâ€¿bNâ€¿bAâ€¿bWâ€¿bPâ†â‰Â¨ËœâŸœ(+`Â»)cgl
Mâ†1âŠ¸âŠ‘(0âŠ¸â‰¤âˆ§>)-âŸœâŠ‘
viâ†âŠ‘bD
charRoleâ†((âŠ‘bI)â†‘/0âˆ¾3â†‘cgl)âˆ¾(5/âŒ½â†•2)âˆ¾0
spcâ†â¥Š3â€¿5â€¿6-âŒœ3â€¿0

Tokenizeâ†{
  râ†ğ•©='#'â‹„sâ†/0â€¿0âŠ¸Â«âŠ¸âˆ§smâ†ğ•©='''â‹„dâ†/dmâ†ğ•©='"'
  gâ†â‹qâ†âˆ¾âŸ¨  sâ‹„Â¯1â†“dâ‹„/râŸ© â‹„qâ†©gâŠq
  eâ† gâŠâˆ¾âŸ¨2+sâ‹„ 1â†“dâ‹„-âŸœÂ»âˆ˜âŠâŸœ(0âˆ¾+`r)âŠ¸//(ğ•©=lf)âˆ¾1âŸ©
  Seâ†{(âŠËœğ•¨)Se 1Â¨âŒ¾((ğ•©/ğ•¨)âŠ¸âŠ)ğ•©}âŸ{0=Â¯1âŠ‘ğ•©}
  stâ†Â¯1â†“SeâŸœ(1â†‘Ëœâ‰ )âˆ¾âŸœâ‰ qâ‹eâ‹„q/Ëœâ†©stâ‹„e/Ëœâ†©st
  nâ†â‰ ğ•©â‹„aâ†nâ†‘/â¼qâ‹„bâ†nâ†‘/â¼e
  fâ†Â¬(â‰ `aâˆ¨b)âˆ¨Â«qeâ†aâˆ§Â»âŠ¸âˆ§dm
  "Unclosed quote"!Â¬âˆ¨Â´(smâˆ¨dm)âˆ§b<f

  uâ†fâˆ§ğ•©='@'â‹„ciâ†/uâˆ¨Â»aâˆ§sm
  chrâ†(ciâŠğ•©)-(ciâŠu)Ã—'@'-@
  strâ†1â†“Â¨ğ•©âŠ”Ëœ1-Ëœ(+`siâ†dmâˆ§a>qe)Ã—â‰ `dmâˆ§aâˆ¨b

  câ†CharCode f/ğ•©
  wâ†Â»âŠ¸<lâ†c M bD(âŠ£â‰-Ëœ)â—‹âŠ‘bWâ‹„usâ†c=Â¯1++Â´bA
  twâ†naâŒŠâˆ˜Ã·Ëœ(âŠ‘bA)-Ëœw/c
  c-â†©naÃ—lâˆ§câ‰¥na+âŠ‘bA
  liâ†l>inâ†lâˆ§(+`w)âŠ0âˆ¾tw<0
  numâ†ReadNums inâˆ¨âŸœÂ«âŠ¸/â—‹(0âŠ¸âˆ¾)cÃ—l
  tiâ†(us/ËœÂ«âŠ¸<li)(âŠ¢+âˆ§âŸœ(2âŠ¸=))0âŠ¸â‰¤âŠ¸/tw
  idâ†(1-Ëœ(li>us)Ã—+`w>in)âŠ”c
  kiâ†((â‹âŠâŸœin)âŠ¸âŠ/w)âˆ¾(ciâˆ¾/si)âŠ+`Â»f

  kâ†idâ€¿numâ€¿chrâ€¿strâ‹„k(âŠ¢>Â¯1Â»âŒˆ`)âŠ¸/Â¨Ëœâ†©jâ†âŠÂ¨k
  câ†©(wâˆ¨Â¬lâˆ¨c M bW)/(âˆ¾j++`viÂ»â‰ Â¨k)âŒ¾(kiâŠ¸âŠ)c
  c/Ëœâ†©Â¬(1Â»(câˆŠ2â€¿4+âŠ‘bB)âˆ¨âŠ¢)âŠ¸âˆ§c M bSâ‹„c/Ëœâ†©Â¬(1Â«câˆŠ3â€¿5+âŠ‘bB)âˆ§c M bS
  tâ†tiâŒ¾((c M viâˆ¾â‰ âŠ‘k)âŠ¸/)(viâŒŠc)âŠcharRole
  c+â†©5Ã—c M 5â‰ËœâŠ‘bI
  âŸ¨c,t,â‰ âŠ‘k,âˆ¾1â†“kâŸ©
}

ErrNumericCharsâ†{
  âŸ¨"Letter","s"/Ëœ1<â‰ ğ•©," """,ğ•©âŠcharSet,""" not allowed in numbers"âŸ©âˆ¾âŠ¸!0
}
ReadNumsâ†{
  eâ€¿pâ€¿iâ€¿nâ€¿dâ†=âŸœğ•©Â¨((âŠ‘bA)+-Â´"ea")âˆ¾+âŸœâ†•Â´bN  # eÏ€âˆÂ¯.
  ErrNumericCharsâˆ˜(/âŸœğ•©)âŸ(âˆ¨Â´) Â¬eâˆ¨ğ•©<âŠ‘bA
  mâ†Â¬nâˆ¨sâ†dâˆ¨câ†eâˆ¨zâ†0=ğ•©
  "Negative sign in the middle of a number" ! âˆ§Â´nâ‰¤Â»c
  "Portion of a number is empty" ! Â¬âˆ¨Â´(Â»Â¬m)âˆ§s
  "Ill-formed decimal or exponent use" ! âˆ§Â´(0âŠ¸=âˆ¨Â»âŠ¸<)s/ğ•©
  "Ï€ and âˆ must occur alone" ! âˆ§Â´(pâˆ¨i)â‰¤1(Â»âˆ§(pâˆ§Â«e)âˆ¨Â«)zâˆ¨n
  lâ†(Â¯1âˆ¾Ï€â€¿1âˆ¾Ëœâ†•10)âŠËœ(Â¬d)/mÃ—ğ•©-1-ËœâŠ‘bD
  vâ†(>âŸœÂ«0â‰¤l)/(0âŠ¸â‰¤Ã—Ã—âŸœ10âŠ¸+)`Â»Â«l
  vÃ—â†©1â€¿Â¯1âŠËœ(râ†>âŸœÂ»dâˆ¨m)/Â»n
  vmâ†c/z
  ldâ†(âŒˆ`âŠ¢Ã—1+â†•âˆ˜â‰ )dâˆ¾0
  dpâ†vm/(Â»âŠ¸<Ã—-)âŸœ(âŠâŸœld)(â‰ Â«/)c
  tâ†10â‹†|eeâ†dp-Ëœvm/Â«vÃ—Â¬vm
  tÃ·ËœâŒ¾((0>ee)âŠ¸/)tÃ—âŒ¾((0<ee)âŠ¸/)vm/vÃ—(r/i)âŠ1â€¿âˆ
}


LEBv â† {
  bâ†128
  lâ†âŒŠbâ‹†â¼1âŒˆğ•©
  oâ†â‹â‹((â†•Â¯1âŠ‘âŠ¢)-/âŸœÂ»)âŸœ(+`)1+l
  oâŠl{fâ†Ã—ğ•¨â‹„(ğ•¨-1)(bâŠ¸(Ã—âŸœf+|)âˆ¾ğ•ŠâŸœ(âŒŠÃ·âŸœb)â—‹(fâŠ¸/))âŸ(âˆ¨Â´f)ğ•©}ğ•©
}

ErrMismatchedBracketsâ†{
  Lcs â† Â¯1 âŠ‘ 0Ë˜âˆ˜âŠ¢ {ğ•©âŒˆâŒˆ`ğ•¨+Â«ğ•©}Ë =âŒœ
  _mis_ â† {"Missing "âˆ¾ğ•—âˆ¾" "âˆ¾charSetâŠËœğ•˜+âŠ¢/Ëœâ‰ âˆ˜âŠ£=âŠ’}
  Msg â† >â—‹â‰ â—¶âŸ¨"opening"_mis_ 0, "closing"_mis_ 1ËœâŸ©
  0 !Ëœ ğ•¨ (Lcs<âŒŠâ—‹â‰ )â—¶âŸ¨Msg,"Malformed bracket nesting"âŸ© ğ•©
}
ErrUndeclaredâ†{
  0 !Ëœ "Undefined identifier"âˆ¾(1<â‰ ğ•©)/"s"
}
Parse â† {nvâ€¿râ†ğ•¨
  gâ†â‹pdâ†+`pâ†ğ•©(MÃ—Â¯1â‹†2|-âŸœâŠ‘)bBâ‹„brâ†pÃ—ğ•©M 2â‰Ëœ2+âŠ‘bB
  p(=âŸœ1âŠ¸/ErrMismatchedBracketsâŸâ‰¢1-Ëœ=âŸœÂ¯1âŠ¸/)â—‹(gâŠ¸âŠ)ğ•©
  "Swapped open and closed brackets" ! 0â‰¤(âŠ‘g)âŠ‘pd
  slâ†Â«âŠ¸âˆ¨ğ•© M bLâ‹„srâ†Â»âŒ¾(gâŠ¸âŠ)slâ‹„saâ†slâˆ¨sr
  gâŠËœâ†©â‹gâŠslâ‹„rÃ—â†©Â¬saâ‹„oâ†p>0
  ptâ†sa<ğ•©=1+âŠ‘bB
  revâ†â‹+`1+Â¯1â†“g((Â¯1âˆ¾âŠ£)(âŠ£â‹âŠ¸âŠâŠËœ-âŠËœâŸœâ‹)âŸœâ‹1(+`âˆ˜âˆ¾-âˆ¾Ëœ)âŠ)oâˆ¨slâˆ¨ğ•© M bS

  gfâ†â‹fdâ†+`revâŠbr
  revâŠËœâ†©gfâ‹„fdâŠËœâ†©gf
  ğ•©âŠËœâ†©revâ‹„bvâ†revâŠbrâ‹„bâ†/bv<0â‹„fiâ†+`câ†bv>0

  Hâ†Â¬Â·1âŠ¸Â«âŠ¸/c(âˆ¨/âŠ£)=
  ftâ†(0âˆ¾1âŠ¸H+2Ã—2âŠ¸HâŒˆ2Ã—3âŠ¸H)(0â€¿3â€¿4â€¿5+5+âŠ‘bI)â‹ğ•©
  fscâ†ftâŠspc
  râ†©((1â†“ft)âŠ(1+2âŠ¸â‰¤)âŠ¸/â†•4)âŒ¾((bâŠrev)âŠ¸âŠ)r
  r+â†©pt(âŠ£âˆ§Â¬âŠ¸âˆ¨=â—‹(âŒˆ`(1+â†•âˆ˜â‰ )âŠ¸Ã—)âŠ¢)(Â»âŒ¾(gâŠ¸âŠ)3=r)âˆ¨1â‰¤r

  idâ†/idmâ†(0âŠ¸â‰¤âˆ§<âŸœnv)xvâ†ğ•©-viâ‹„idxâ†idâŠğ•©â‹„spâ†/ğ•© M bI
  adâ†(âŒˆ`â†•âˆ˜â‰ âŠ¸Ã—ğ•© M bG)âŠğ•©=âŠ‘bG

  gâ†©â‹+`revâŠp-brâ‹„grâ†gâŠrevâ‹„sllâ†1+2Ã·Ëœ0(<-â—‹/>)grâŠsr-slâ‹„lâ†/gâŠğ•©=5+âŠ‘bB
  gâŠËœâ†©gsâ†â‹grâŠslâ‹„grâ†©gâŠrevâ‹„ğ•©âŠËœâ†©gâ‹„râŠËœâ†©grâ‹„oâŠËœâ†©grâ‹„siâ†/grâŠsr>sl
  giâ†â‹gâ‹„lâŠâ†©â‹gs
  sâ†ğ•© M bSâ‹„psâ†sâˆ¨oâˆ¨grâŠslâ‹„aâ†ğ•© M 2â‰ËœâŠ‘bG
  r-â†©psâˆ¨aâ‹„opâ†râ‰¥2â‹„feâ†(râ‰¥1)âˆ¨Â«r=3
  trâ†(âŒˆ`â†•âˆ˜â‰ âŠ¸Ã—Â»ps)âŠfe
  maâ†tr<(ğ•©=1+âŠ‘bG)âˆ§Â«fe
  roâ†opâˆ¨a<Â«r=3â‹„osâ†âŒ½â†•âˆ˜â‰ âŠ¸(âŠ£-âŒˆ`âˆ˜Ã—)âŒ½Â¬roâˆ¨maâ‹„atâ†(âŠ¢+1+âŠâŸœos)/a
  aaâ†gâŠasnâ†Â»+`giâŠ-âŸœÂ»(â‰ ğ•©)â†‘/â¼at-1â‹„râ†©Â¯1Â¨âŒ¾(aaâŠ¸/)r
  tfâ†(aâ‰¤â—‹(âŒˆ`(1+â†•âˆ˜â‰ )âŠ¸Ã—)ps)âˆ§(âŠ¢âˆ§2(|<â‰¤)ps(âŠ¢-âŒˆ`âˆ˜Ã—)+`)Â¬ro
  opaâ†op>Â«psâˆ¨a
  oaâ†âŒ½/opaâ‹„faâ†/(Â«aa)<(tfâˆ¨Â¬tr)âˆ§(roâˆ§Â«opa)<(r=1)âˆ¨op<Â»opa
  dyâ†faâŠÂ«(ğ•©â‰ âŠ‘bO)âˆ§(trâˆ§râ‰¥0)âˆ¨ro<r=0
  nâ†ğ•©â‰¥vi+nvâ‹„cnâ†/nâˆ¨ğ•©â‰¤Â¯1++Â´bCâ‹„uâ†âˆ§â·obâ†cnâŠğ•©
  loâ†(o/ğ•©)=4+âŠ‘bBâ‹„llâ†1+lo/1(â†“--âŠ¸â†“)(oâˆ¾1)/+`(sâˆ¾0)-(1âˆ¾o)âˆ§psâˆ¾1
  drâ†/s>o+`âŠ¸âŠ0âˆ¾loâ‹„rtâ†/ğ•©=2+âŠ‘bB

  dâ†idâŠdecâ†idmâˆ§adâˆ§asnâ‹„lcâ†-âŸœÂ»(câˆ¾1)/+`decâˆ¾0
  ixfâ†(âŠâŸœ(Â¯1âˆ¾c/gf)âˆ¾dâŠ¸/âŠ((â‰ ğ•©)âˆ¾bâŠgf)Ëœ)idâŠfi
  igâ†(â‹âŠâŸœ(ixxâ†âˆ¾âŸœ(dâŠ¸/)idx))âŠ¸âŠâ‹ixf
  "Multiple definitions" ! 1âˆ§Â´ixxâˆ¨â—‹(Â»âŠ¸â‰ ((â‰ id)âŠ¸â‰¤âŠ¸/ig)âŠâŠ¢)ixf
  igâ†©<âŸœ(â‰ id)âŠ¸/(â‹+`âˆ˜âŠâŸœ(dâˆ¾-/Ëœd))âŠ¸âŠig
  dâŠËœâ†©igâ‹„ErrUndeclaredâˆ˜/ËœâŸ(0âˆ¨Â´âŠ¢)âŸœ(d<Â»âŠ¸â‰ )igâŠidx
  uiâ†(âŒˆ`â†•âˆ˜â‰ âŠ¸Ã—d)âŠ¸âŠâŒ¾(igâŠ¸âŠ)id
  iiâ†(uiâŠ(fiâŠfsc)-(âŒˆ`câŠ¸Ã—)âŠ¸Â¬+`dec)âˆ¾((spâŠfi)âŠ3Ã—2|ft)++âŸœ(0âŠ¸â‰¤)2+spâŠxv
  idorâ†âˆ¾3â¥Š<isâ†idâˆ¾sp
  idbcâ†âŸ¨21+isâŠasn,(id-â—‹(âŠâŸœfd)ui)âˆ¾0Â¨sp,iiâŸ©

  bâŠâ†©gi
  orâ†â‹idorâˆ¾gâŠËœâˆ¾âŸ¨cn,cn,b,b,rt,dr,l,l,si,si,at,oa+1âŒˆoaâŠos,(dyÃ—âŠâŸœos)âŠ¸+fa+dyâŸ©
  bc0â†âˆ¾idbcâˆ¾âŸ¨0Â¨cn,uâŠob,15Â¨b,1+â†•â‰ bâŸ©
  bcâ†orâŠbc0âˆ¾âˆ¾âŸ¨25Â¨rt,14Â¨dr,3+lâŠaa,ll,3+siâŠaa,sll,(11-âŠ‘bG)+a/ma+ğ•©,5+oaâŠr,(âŠ¢+9Ã—10âŠ¸=)16+dy-7Ã—faâŠtrâŸ©
  fsâ†(ftâŠâ¥Š3â‰âŒœâŸœâŒ½â—‹â†•2)âˆ¾Â¨((+`0âˆ¾1+âŒŠ128â‹†â¼1âŒˆbc)âŠËœ/1âˆ¾or M bc0â‰â—‹â‰ rt)â‰â—‹<Â¨lc+fsc
  âŸ¨LEBv bcâˆ¾25,u,fsâŸ©
}

Compileâ†{
  âŸ¨t,r,nVar,constâŸ©â†Tokenizeğ•©
  âŸ¨bc,u,blkâŸ©â†nVarâ€¿r Parse t
  oâ†(u-(vi+nVar-â‰ ğ•¨)Ã—uâ‰¥vi)âŠğ•¨âˆ¾const
  âŸ¨bc,o,blkâŸ©
}
