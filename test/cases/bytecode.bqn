# Tests of bytecode operations.
# These use no primitives, so that compiled code can be run directly in
# a correct VM even if it has no runtime.
# Compile with a command such as $ src/cjs.bqn "aâ†2â‹„bâ†3â‹„a"

# Tests are meant to be run in order; comments indicate new instructions
# introduced by each.

5  % 5                     #  0 PUSH, 25 RETN
3  % 4â‹„3                   # 14 POPS
5  % aâ†5                   # 22 LOCM, 11 SETN
4  % aâ†5â‹„aâ†©4               # 12 SETU
2  % aâ†2â‹„bâ†3â‹„a             # 21 LOCO
1  % aâ†1â‹„A 4               # 16 FN1O
2  % aâ†2â‹„3 A 4             # 17 FN2O
6  % {ğ•©}6                  # 15 DFND
3  % Aâ†{ğ•¨}â‹„3 A 4           #    dyadic block function
7  % aâ€¿bâ†7â€¿2â‹„a             #  3 ARRO,  4 ARRM
4  % 4{ğ”½}6                 #  7 OP1D
6  % 4{ğ”½â‹„ğ•©}6               #    deferred modifier
1  % 3{ğ”¾}{ğ•©} 1             #  8 OP2D
2  % (2{ğ”½}{ğ•©})3            #  9 TR2D
3  % 3({aâ€¿bâ†ğ•©â‹„a}{ğ•¨â€¿ğ•©})4    #    dyadic 2-train
4  % 4({ğ•¨â€¿ğ•©}{ğ•©}{ğ•¨})5       # 19 TR3O
2  % aâ€¿bâ†(2{ğ•¨â€¿ğ•©}{ğ•©})5â‹„a    #    monadic, data in left branch
2  % ({aâ†©2â‹„ğ•©}{ğ•©â‹„a}{aâ†©3â‹„ğ•©})aâ†4 # ordering
8  % aâ†3â‹„a{ğ•©}â†©8â‹„a          # 13 SETM
4  % aâ€¿bâ†2â€¿1â‹„aâ€¿b{ğ•©â€¿ğ•¨}â†©4â‹„a  #    lists
