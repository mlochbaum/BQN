#! /usr/bin/env dbqn

ncâ€¿rtâ€¿prim â† "-nocomp"â€¿"-rt"â€¿"-prim" âˆŠ â€¢args
"Can't test runtime without the compiler!" ! Â¬ncâˆ§rt

âŸ¨DRun,DCompileâŸ© â† â€¢Import "../dc.bqn"

GetRT â† {ğ•¤:
  âŸ¨refâŸ© â† â€¢Import "../src/pr.bqn"
  provide â† âŸ¨
    â€¢Type      # Type
    â€¢Decompose # Decompose
    â€¢Glyph     # Glyph
    âŠ‘âŸ¨âŸ©â¥Š0âŠ¸â¥Š    # GetFill
    â‹†â¼         # Log
    â‰ Â¨âŠ”        # GroupLen
    âˆ¾âŠ”âˆ˜âŠ¢       # GroupOrd
    !,+,-,Ã—,Ã·,â‹†,âŒŠ,=,â‰¤,â‰¢,â¥Š,âŠ‘,â†•,âŒœ,`,âŠ˜
  âŸ©
  â€¢COMP provideâŠ¸(âŠ£Â»Â«)âŒ¾(1âŠ¸âŠ‘) DCompile ref
}

Native â† {âğ•©}
exec â† (rtÂ¬nc)â—¶âŸ¨NativeË™, DRunË™, {ğ•©âŠ¸DRun}âˆ˜GetRTâŸ© @

c â† âˆ¾(â€¢FLines âˆ¾âŸœ"cases.bqn")Â¨""â€¿"b"
{ğ•©: c âˆ¾â†© "1 %"âŠ¸âˆ¾Â¨ (0<â‰ )â—¶0â€¿((Â¬":"âŠ‘âˆ˜âˆŠâŠ¢)âˆ§'#'â‰ âŠ‘)Â¨âŠ¸/ â€¢FLines "prim.bqn" }âŸâŠ¢ prim
M â† {eâ€¿b:
  Err â† {(@+10)âˆ¾Ëœ""""âˆ¾bâˆ¾""": expected "âˆ¾eâˆ¾" but received "âˆ¾â•ğ•©}
  (Native e) â‰¢â—¶""â€¿Err Exec b
}
r â† '%' Mâˆ˜((+`-2âŠ¸Ã—)âˆ˜=âŠ”âŠ¢)Â¨ c
â€¢Out ("All "âˆ¾(â•â‰ c)âˆ¾" passed!")âŸ(0=â‰ ) âˆ¾r
