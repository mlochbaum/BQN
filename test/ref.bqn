src â† ""âŠ¸â‰¢Â¨âŠ¸/ (âˆ§`'#'âŠ¸â‰ )âŠ¸/Â¨ â€¢FLines "../spec/reference.bqn"
lines â† (Â¯1â†“âˆ¾)Â¨(srcâˆ¾Â¨@+10)âŠ”Ëœ+`Â»0=+`+Â´Â¨+Ë-Ë("{âŸ¨"â‰"}âŸ©")=âŒœsrc
assumeâ€¿defs â† (âˆ¨Â´âˆŠâŸœ"â†â†©")Â¨âŠ¸âŠ” lines
LC â† âŠ¢+('a'-'A')Ã—1="A["âŠ¸â‹
anamesâ€¿names â† (LC' 'âŠ¸â‰ âŠ¸/)Â¨Â¨ âŸ¨assume, (âˆ§`Â·Â¬âˆŠâŸœ"â†â†©")âŠ¸/Â¨ defsâŸ©

nIsPâ†(1=â‰ )Â¨names
NextSame â† â‰ (âŠ¢â‹âŠ¸âŠâ—‹âˆ¾Â«Â¨)âŠ”âˆ˜âŠ
range â† {(â‰ âŒœËœ âˆ§ nIsP â‰¤â‰1 â‰¥âŒœËœ âˆ§ (NextSameğ•©)>âŒœâŠ¢) â†•â‰ ğ•©} names

idChars â† "_Â¯.Ï€âˆğ•£"âˆ¾âˆ¾"0aA"+âŸœâ†•Â¨10â€¿26â€¿26
defTok â† (Â¯1+`Â·Â¬Â·Â»âŠ¸âˆ§âˆŠâŸœidChars)âŠ¸âŠ”Â¨ defs
depend â† <âˆ˜/Ë˜ range âˆ§ > (namesâˆŠLCÂ¨)Â¨ (0=Â·+`Â·-Ë"{"â€¿"}"â‰¡âŒœâŠ¢)âŠ¸/Â¨defTok
order â† {{(ğ•¨âŠ¸âˆ¨ğ•ŠâŸ(ğ•©<â—‹â‰ âŠ¢)ğ•©âˆ¾/)(0Â»âˆ¨`)âŠ¸<ğ•¨<âˆ§Â´âˆ˜âŠâŸœğ•¨Â¨l}âŸœ/0Â¨lâ†ğ•©} depend

chrs â† â€¢Import "../src/glyphs.bqn"

defâ€¿keep â† âŠ‘Â¨âŒ¾(1âŠ¸âŠ‘) (1=â‰ )Â¨âŠ¸âŠ” anames
keepâˆ¾â†©"âŒ¾âŠ"
preâ†"Typeâ†â€¢Type"â€¿"_amendâ†{ğ•¨Ë™âŒ¾(ğ•—âŠ¸âŠ‘)ğ•©}"â€¿"Identityâ†{ğ•Â´âŸ¨âŸ©}"â€¿"Fillâ†âŠ‘âˆ˜Â»1â†‘â¥Š"

GetRepls â† {
  ki â† (âŠ‘Â¨âŠ‘ğ•©)âˆŠkeep
  âŠ£âŒ¾(kiâŠ¸/)` ğ•©
}

âŸ¨E_procâŸ© â† chrsâ€¿GetRepls â€¢Import "../src/pp.bqn"

rslt â† "âŸ¨"âˆ¾"âŸ©"Â«âˆ¾","âŠ¸âˆ¾Â¨âˆ¾chrs  # Output all primitives
â€¢BQN âˆ¾âˆ¾âŸœ(@+10)Â¨ pre âˆ¾ orderâˆ¾âŸœâ‰ âŠ¸âŠE_procÂ¨ defsâˆ¾<rslt
