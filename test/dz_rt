#!/usr/bin/env dbqn

# Compile and run the primitive implementations, and prim.bqn

⟨ref⟩ ← •Import "../src/pr.bqn"
⟨DRun,DCompile⟩ ← •Import "../dc.bqn"

provide ← ⟨
  0≠≡      # IsArray
  ⊑⟨⟩⥊0⊸⥊  # Type
  ⋆⁼       # Log
  ≠¨⊔      # GroupLen
  ∾⊔∘⊢     # GroupOrd
  !,+,-,×,÷,⋆,⌊,=,≤,≢,⥊,⊑,↕,⌜,`,⊘
⟩
rt ← •COMP provide⊸(⊣»«)⌾(1⊸⊑) DCompile ref

t ← "¬⟨"‿"⟩" (1⌽⌽⊸∾) (¬∘⊑':'∊⊢)¨⊸/ •LNS "prim.bqn"
res ← rt DRun ∾ ∾⟜(@+10)¨ t

•Out ("All "∾(⍕≠res)∾" passed!")⍟(0=≠) /res
