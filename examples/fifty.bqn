# First, a word about the examples folder
# Yes, it only has this file and more will not be added
# This file is from when there weren't many examples and now I don't want to break links
# Look in these places for examples instead:
# https://mlochbaum.github.io/bqncrate/
# https://mlochbaum.github.io/BQN/community/index.html

# A history of APL in 50 functions
# But they're BQN functions
# Still about APL history though
# https://www.jsoftware.com/papers/50/

# Utilities
Words â† (âŠ¢-ËœÂ¬Ã—+`)âˆ˜=âŸœ' 'âŠ¸âŠ”  # Split string on spaces
Rand â† â€¢rand.Range
BConv â† {âŒ½âŠ‘Â¨(<0â€¿ğ•©){Â·â€¿b ğ•Š ğ•©:âŸ¨ğ•©|b,âŒŠbÃ·ğ•©âŸ©}`âŒ½ğ•¨}  # Substitute for one case of âŠ¤
Enc â† {+Â´ğ•©Ã—âŒ½Ã—`âŒ½1Â«ğ•¨}  # Substitute for one case of âŠ¥
Binary â† 2{âŒ½ğ•—|âŒŠâˆ˜Ã·âŸœğ•—âŸ(â†•1+Â·âŒŠğ•—â‹†â¼1âŒˆâŠ¢)}  # Substitute for 2âŠ¥â£Â¯1
_fix â† {ğ”½âˆ˜âŠ¢âŸâ‰¢âŸœğ”½_ğ•£âˆ˜âŠ¢âŸâ‰¢âŸœğ”½ğ•©}  # Substitute for â£â‰¡
# One case of matrix division:
# Solve lower triangular matrix equation by forward substitution
SolveLTri â† { t ğ•Š b:
  Row â† { newâ†bÃ·â—‹âŠğ•© â‹„ bâ†©b-âŸœ(Ã—âŒœâŸœnew)â—‹(1âŠ¸â†“)ğ•© â‹„ new }
  > (â†•âˆ˜â‰  Rowâˆ˜â†“Â¨ âŠ¢) <Ë˜â‰t
}

# 0
ArrayLogic â† (>-<)âŸœ0
! 1â€¿Â¯1â€¿0â€¿1 â‰¡ ArrayLogic 5â€¿Â¯2.7â€¿0â€¿6

# 1
Average â† +Â´Ã·â‰ 
! 3 â‰¡ Average 2â€¿1â€¿6

# 2
# xâŒ¹x=x is an alternate way to get the average of vector x.
# There's no reason to do it this way in BQN (or APL, really).

# 3
IndexOfSelfie â† âŠËœ
! 0â€¿1â€¿2â€¿3â€¿4â€¿1 â‰¡ IndexOfSelfie "Selfie"

# 4
BarChart â† ".â•"âŠËœ>âŒœâŸœ(â†•âŒˆÂ´)
! {
  bc â† BarChart 3â€¿1â€¿4â€¿1â€¿5â€¿9
  bc â‰¡ 6â€¿9â¥Š"â•â•â•......â•........â•â•â•â•.....â•........â•â•â•â•â•....â•â•â•â•â•â•â•â•â•"
}

# 5
ParenthesesNesting â† +`1â€¿Â¯1â€¿0âŠËœ"()"âŠâŠ¢
! {
  pn â† ParenthesesNesting "âµ((âˆ‡<S),=S,(âˆ‡>S))âµâŒ·â¨?â‰¢âµ"
  pn â‰¡ 0â€¿1â€¿2â€¿2â€¿2â€¿2â€¿1â€¿1â€¿1â€¿1â€¿1â€¿2â€¿2â€¿2â€¿2â€¿1â€¿0â€¿0â€¿0â€¿0â€¿0â€¿0â€¿0
}

# 6
PerfectShuffle â† âŠ¢âŠËœÂ·â‹âˆ˜â’â‰ â¥Š0â€¿1Ë™
! "IAJBKCLDMENFOGPHQ" â‰¡ PerfectShuffle "ABCDEFGHIJKLMNOPQ"

# 7
_quicksort â† {Cmpâ†ğ”½ â‹„ Sâ†{pâ†ğ•©CmpËœğ•©âŠËœRandâ‰ ğ•© â‹„ âˆ¾1â€¿0â€¿1ğ•©{SâŸğ•¨ğ•—/Ëœ0ğ•p}Â¨<â€¿=â€¿>}âŸ(1<â‰ )}
! 1â€¿2â€¿2â€¿3â€¿5â€¿7â€¿9â€¿10â€¿10â€¿10â€¿11â€¿14â€¿16 â‰¡ -_quicksort 2â€¿2â€¿7â€¿10â€¿10â€¿11â€¿3â€¿10â€¿14â€¿5â€¿9â€¿1â€¿16
! {
  Cmp â† â‰¢â—¶0â€¿(-Â´âˆ˜â‹âˆ¾â—‹<)Â¨
  srt â† Words "Anna Fi JD Jay Jd John Morten Roger Scott Zeus"
  srt â‰¡ Cmp _quicksort Words "Fi Jay John Morten Roger JD Jd Anna Scott Zeus"
}

# 8
PascalsTriangle â† {>ğ•©â†‘Â¨0(âˆ¾+âˆ¾Ëœ)âŸ(â†•ğ•©)â¥Š1}
! [1â€¿0â€¿0â€¿0â‹„1â€¿1â€¿0â€¿0â‹„1â€¿2â€¿1â€¿0â‹„1â€¿3â€¿3â€¿1] â‰¡ PascalsTriangle 4
! 1â€¿1â€¿2â€¿3â€¿5â€¿8â€¿13â€¿21â€¿34â€¿55 â‰¡ { ğ•© â†‘ +Â´Â¨ (+âŒœËœâ†•ğ•©) âŠ”â—‹â¥Š PascalsTriangle ğ•© } 10

# 9
GoldenRatio â† Ã·âŠ¸+`â¥ŠâŸœ1
! 1eÂ¯5 âˆ§Â´âˆ˜> | (GoldenRatio 16) - 1â€¿2â€¿1.5â€¿1.66667â€¿1.6â€¿1.625â€¿1.61538â€¿1.61905â€¿1.61765â€¿1.61818â€¿1.61798â€¿1.61806â€¿1.61803â€¿1.61804â€¿1.61803â€¿1.61803

# 10
NewtonsMethod â† (2 Ã·Ëœ âŠ£ + Ã·Ëœ)` â¥Š
! 1eÂ¯5 âˆ§Â´âˆ˜> | (7 NewtonsMethod 2) - 2â€¿1.5â€¿1.41667â€¿1.41422â€¿1.41421â€¿1.41421â€¿1.41421

# 11
InnerProduct â† +Ëâˆ˜Ã—â‰1â€¿2
! [2â€¿3â‹„4â€¿1] â‰¡ [1â€¿0â‹„Â¯1â€¿1] InnerProduct [2â€¿3â‹„6â€¿4]

# 12
CayleysTheorem â† {Râ†â¥ŠâŠâŠ¢ â‹„ (Rğ•©) â‰¡ R âŠËœâŒœËœ <Ë˜Rğ•©}
! {
  t â† 2â€¿2âŠ¸â¥ŠÂ¨ (âŒ½2|âŒŠâˆ˜Ã·âŸœ2âŸ(â†•4))Â¨ 9â€¿6â€¿7â€¿11â€¿13â€¿14
  g â† â‰ Ëâˆ˜âˆ§â‰1â€¿2âŒœËœt
  CayleysTheorem g
}

# 13
d8 â† [
  âŸ¨âŠ¢ , â’ , â’â’, â‹âŒ½, âŒ½ , â‹ , â‹â’, â’âŒ½âŸ©
  âŸ¨â’ , â’â’, â‹âŒ½, âŠ¢ , â’âŒ½, âŒ½ , â‹ , â‹â’âŸ©
  âŸ¨â’â’, â‹âŒ½, âŠ¢ , â’ , â‹â’, â’âŒ½, âŒ½ , â‹ âŸ©
  âŸ¨â‹âŒ½, âŠ¢ , â’ , â’â’, â‹ , â‹â’, â’âŒ½, âŒ½ âŸ©
  âŸ¨âŒ½ , â‹ , â‹â’, â’âŒ½, âŠ¢ , â’ , â’â’, â‹âŒ½âŸ©
  âŸ¨â‹ , â‹â’, â’âŒ½, âŒ½ , â‹âŒ½, âŠ¢ , â’ , â’â’âŸ©
  âŸ¨â‹â’, â’âŒ½, âŒ½ , â‹ , â’â’, â‹âŒ½, âŠ¢ , â’ âŸ©
  âŸ¨â’âŒ½, âŒ½ , â‹ , â‹â’, â’ , â’â’, â‹âŒ½, âŠ¢ âŸ©
]
PM â† âŠ¢=âŒœâ†•âˆ˜â‰ 
MP â† âŠâŸœ1Ë˜
p â† 6â€¿3â€¿2â€¿1â€¿5â€¿4â€¿0
! (âŠ¢  PM p) â‰¡ PM âŠ¢p
! (â‰  PM p) â‰¡ PM â‹p
! (âŒ½â‰ PM p) â‰¡ PM â’p
! (âŒ½  PM p) â‰¡ PM âŒ½p
rp â† â€¢rand.Deal 7
! (d8{ğ•ğ•©}Â¨<p) â‰¡ ({ğ•âˆ˜ğ•}âŒœËœâŠd8){ğ•ğ•©}Â¨<p
! CayleysTheorem d8

# 14
IntervalIndex â† 1-Ëœâ‰ âˆ˜âŠ£(âŠ£â†“âŠ¢â‹âŠ¸âŠ+`âˆ˜>)â‹âˆ˜âˆ¾  # Or â‹, of course
! 0â€¿2â€¿3â€¿2â€¿4â€¿1â€¿0â€¿2â€¿Â¯1 â‰¡ Â¯1â€¿2â€¿3â€¿7â€¿8.5 IntervalIndex 0â€¿4â€¿7â€¿6â€¿11â€¿2â€¿1â€¿3â€¿Â¯5
! 0â€¿1â€¿0â€¿Â¯1â€¿4â€¿4 â‰¡ "Fi Jay John Morten Roger" IntervalIndexâ—‹Words "JD Jd Geoff Anna Scott Zeus"

# 15
CentralLimit â† { 41 â†‘ /â¼ (5Ã—â†•40) â‹ +Ë Rand ğ•©â¥Š21 }
# 5â€¿8 â¥Š CentralLimit 10 1e3

# 16
PN â† {1â‰¥ğ•© ? 0â‰¤ğ•©; -Â´+Ëğ•ŠÂ¨Rec ğ•©}
Rec â† {ğ•© - (Ã·âŸœ2 (Ã—â‰1) Â¯1â€¿1 +âŒœ 3âŠ¸Ã—) 1+â†•âŒˆâˆšğ•©Ã—2Ã·3}
! 1â€¿1â€¿2â€¿3â€¿5â€¿7 â‰¡ PNÂ¨â†•6
# APL/J string manipulation approach doesn't work because â€¢BQN can't access outside variables
# Use first class functions instead
Cond â† {1â‰¥ğ•©}, Base â† {0â‰¤ğ•©}, _genâ†{-Â´+Ëğ”½Â¨Rec ğ•©}
_memo â† { ğ•¨ câ€¿bâ€¿g _ğ•£ ğ•©:
  t â† (1+ğ•¨â‹ˆğ•©)â¥ŠÂ¯1
  ğ•¨{
    ğ•¨Cğ•© ? ğ•¨Bğ•©;
    Â¯1â‰¢tâŠ‘Ëœğ•¨â‹ˆğ•© ? âŠ‘tâŠ‘Ëœğ•¨â‹ˆğ•©;
    vâ†ğ•¨ ğ•Š _g ğ•©
    t vâŒ¾((ğ•¨â‹ˆğ•©)âŠ¸âŠ‘)â†©
    v
  }ğ•©
}
! (PN 10) â‰¡ condâ€¿baseâ€¿gen _memo 10
# Time comparison on a local machine:
#    )t condâ€¿baseâ€¿gen _memo 30
# 187.1us
#    )t PN 30
# 2.6586s

# 17
SeventeenTwentyNine â† {F:
  c â† 3â‹†Ëœ1+â†•200
  t â† (<âŒœËœâ†•200) Ã— +âŒœËœc
  d â† â·âŠ¸âŠâŠ¸âŠ” â¥Št
  âŒŠÂ´ âŠ‘Â¨ (2=â‰ Â¨)âŠ¸/ d
}
! 1729 â‰¡ SeventeenTwentyNineâŸ¨âŸ©

# 18
WinSimple â† { ğ•Š h:
  m â† â‰ h
  s â† (â‰ âŒœËœâ†•m) +Ëâˆ˜Ã—â‰Â¯1â€¿âˆ h  # or sâ†+Â´âŠ¸-h
  m|(â†•m)-s
}
Win â† {
  # winning strategy based on group table ğ•¨ for hat numbering ğ•©
  ! âˆ§Â´ğ•©âˆŠâ†•mâ†â‰ ğ•©
  wâ†ğ•¨âŠ£m|+âŒœËœâ†•m      # default is + modulo m
  ! mâ€¿mâ‰¡â‰¢w
  ! â‰âŠ¸â‰¡w           # must be abelian
  gâ†âŠâŠ¸âŠw           # standardize group table
  GSâ†(â‹ˆâŠ‘gË™)Â¨       # group operation
  GIâ†{âŠ‘0âŠËœğ•©âŠg}Â¨    # inverses
  (â†•m) GS GI (â‰ âŒœËœâ†•m) GSÂ´âˆ˜Ã—â‰Â¯1â€¿âˆ ğ•©
}
Mgrp â† {ğ•©|Ã—âŒœËœ/1=ğ•©â€¢math.GCDâ†•ğ•©}
! {
  h â† 1â€¿9â€¿5â€¿6â€¿2â€¿0â€¿8â€¿8â€¿12â€¿4â€¿6â€¿10â€¿0
  ! 1 = +Â´ h = WinSimple h
  h88 â† â€¢rand.RangeËœ 88
  ! 1 = +Â´ h88 = WinSimple h88
  ! 1 = +Â´ h88 = Win h88
  coprimes â† / 88 = (+Â´1=â€¢math.GCDâŸœâ†•)Â¨ â†•1000
  ! âˆ§Â´ {1 = +Â´ h88 = (Mgrp ğ•©) Win h88}Â¨ coprimes
}

# 19
Permutations â† {ğ•Š0:1â€¿0â¥Š0; âˆ¾Ë(0âˆ¾Ë˜1+ğ•Šğ•©-1)âŠ¸âŠË˜â’Ë˜=âŒœËœâ†•ğ•©}
! (6â€¿3â¥Š0â€¿1â€¿2â€¿0â€¿2â€¿1â€¿1â€¿0â€¿2â€¿1â€¿2â€¿0â€¿2â€¿0â€¿1â€¿2â€¿1â€¿0) â‰¡ Permutations 3

# 20
InversePermutation â† â‹  # Or âŠâŸœ(â†•â‰ ) or âˆ¾âˆ˜âŠ”
! (â†•10) â‰¡ InversePermutationâŠ¸âŠ 1â€¿4â€¿5â€¿2â€¿6â€¿8â€¿3â€¿7â€¿0â€¿9

# 21
âŸ¨IndexFromPermutationâ‡Ifp,PermutationFromIndexâ‡PfiâŸ© â† {
  Rfd â† âŠ¢+Â´âˆ˜>Â¨Â¯1â†“â†“
  Dfr â† (â‹âˆ˜â‹âˆ¾)Â´
  Ifp â‡ {ğ•Šâ¼:ğ•¨Pfiğ•©; (âŒ½Ã—`1+Â»â†•â‰ ğ•©) +Â´âˆ˜Ã— Rfdğ•©}
  Pfi â‡ {ğ•Šâ¼:ğ•¨Ifpğ•©; wğ•Šğ•©: Dfr (1+â†•w) (âŒ½âŠ£|Â¯1â†“Â·âŒŠâˆ˜Ã·`âˆ¾Ëœ) ğ•©}
}
! {
  p â† 1â€¿3â€¿0â€¿7â€¿6â€¿5â€¿4â€¿9â€¿8â€¿2
  ! p â‰¡ 10 PermutationFromIndex i â† IndexFromPermutation p
  ! p â‰¡ âŠ¢âŒ¾(10âŠ¸IndexFromPermutation) p
  ! i â‰¡ âŠ¢âŒ¾(10âŠ¸PermutationFromIndex) i
}

# 22
Combinations â† {ğ•¨(=âˆ¨0=âŠ£)â—¶âŸ¨(0âˆ¾Ë˜ğ•ŠâŒ¾(-âŸœ1))âˆ¾1+ğ•ŠâŸœ(-âŸœ1), â‰âˆ˜â†•âŠ£âŸ©ğ•©}
! (3 Combinations 5) â‰¡ 10â€¿3â¥Š0â€¿1â€¿2â€¿0â€¿1â€¿3â€¿0â€¿1â€¿4â€¿0â€¿2â€¿3â€¿0â€¿2â€¿4â€¿0â€¿3â€¿4â€¿1â€¿2â€¿3â€¿1â€¿2â€¿4â€¿1â€¿3â€¿4â€¿2â€¿3â€¿4

# 23
âŸ¨IndexFromCombinationâ‡Ic,CombinationFromIndexâ‡CiâŸ© â† {
  C â† (-Ã·â—‹(Ã—Â´)1âŠ¸+)âŸœâ†•Ëœâš‡0  # or â€¢math.CombËœ (APL's dyadic !)
  Ic â‡ {
    ğ•Šâ¼: ğ•¨Ciğ•©;
    mâ€¿nğ•Šğ•©:
    -Â´(m-â†•m) +Ëâˆ˜C n-(Â»1+ğ•©)âˆ¾Ë˜ğ•©
  }
  Ci â‡ {
    ğ•Šâ¼: ğ•¨Icğ•©;
    0â€¿nğ•Šğ•©: âŸ¨âŸ©;
    mâ€¿nğ•Šğ•©:
    vâ†+`(m-1)C(1-m)â†“âŒ½â†•n
    kâ†(v>ğ•©)âŠ1
    kâˆ¾(1+k)+(ğ•¨-1âˆ¾1+k)ğ•Š(ğ•©-kâŠ0âˆ¾v)
  }
}
! 11 â‰¡ 4â€¿6 IndexFromCombination 1â€¿2â€¿3â€¿5
! 1â€¿2â€¿3â€¿5 â‰¡ 4â€¿6 CombinationFromIndex 11
! 11 â‰¡ 4â€¿6 CombinationFromIndexâ¼ 4â€¿6 CombinationFromIndex 11

# 24
SymmetricArray â† â‰âŠ¸â‰¡ âˆ§ 1âŠ¸â‰âŠ¸â‰¡
! SymmetricArray +âŒœÂ´ 3â¥Š<2â€¿3â€¿7â€¿11

# 25
NQueens â† {
  Arr â† {>(âŠ‘âŠ¸âŠâŸœğ•©âˆ¾1âŠ¸âŠ‘)Â¨/â—‹â¥ŠâŸœ(â†•â‰¢)Â¬(â†•ğ•¨)âˆŠâ‰1ğ•©â¥Šâˆ˜+â‰1â€¿2(-âŸœâ†•Â¯1âŠ‘â‰¢ğ•©)Ã—âŒœÂ¯1â€¿0â€¿1}
  ğ•© ArrâŸ(ğ•©-1) â‰Ë˜â†•ğ•©
}
QueenCheck â† {
  ! 1=â‰ â‰¢ğ•©
  ! (â†•â‰ ğ•©)â‰¡âˆ§ğ•©
  ! âˆ§Â´â¥Š(=âŒœËœâ†•â‰ ğ•©)â‰¥(|-âŒœËœğ•©)=|-âŒœËœâ†•â‰ ğ•©
}
QueenCheckË˜ NQueens 8

# 26
KnightsTour â† {
  Kmoves â† {
    t â† (â¥Šâ†•ğ•©â€¿ğ•©)+âŒœ<Ë˜8â€¿2â¥Š2â€¿1â€¿2â€¿Â¯1â€¿1â€¿2â€¿1â€¿Â¯2â€¿Â¯1â€¿2â€¿Â¯1â€¿Â¯2â€¿Â¯2â€¿1â€¿Â¯2â€¿Â¯1
    (âˆ§Ëâ‰1(>t)âˆŠâ†•ğ•©) /Â¨â—‹<Ë˜ ğ•©{+âŸœ(ğ•¨âŠ¸Ã—)Â´âŒ½ğ•©}Â¨t
  }
  m â† >â†‘ËœÂ¨âŸœ(âŒˆÂ´â‰ Â¨) Kmoves ğ•©
  b â† (ğ•©Ã—ğ•©)â¥Š1
  F â† {bâ†©0âŒ¾(ğ•©âŠ¸âŠ‘)b â‹„ (âŠ‘â‹+ËË˜(jâŠm)âŠb)âŠ‘jâ†âŠâŸœbâŠ¸/ğ•©âŠm}
  ğ•©â€¿ğ•©â¥Šâ‹FâŸ(â†•ğ•©â‹†2) 0
}
! (KnightsTour 6) â‰¡ 6â€¿6â¥Š0â€¿9â€¿20â€¿35â€¿6â€¿11â€¿21â€¿32â€¿7â€¿10â€¿19â€¿26â€¿8â€¿1â€¿34â€¿25â€¿12â€¿5â€¿33â€¿22â€¿31â€¿16â€¿27â€¿18â€¿2â€¿15â€¿24â€¿29â€¿4â€¿13â€¿23â€¿30â€¿3â€¿14â€¿17â€¿28

# 27
moo â† {
  # The main game is interactive, but we move these functions outside
  # to define Verify for testing
  Univ  â† {(1=(âŒˆÂ´Â·â‰ Â¨âŠ”)â‰1 t)/tâ†ğ•©(BConvâŸœâŠ‘)â‰1â€¿0â†•Ã—Â´ğ•©}

  Guess â† {ğ•©âŠËœâ€¢rand.Rangeâ‰ ğ•©}
  Solvedâ† {gâ€¿s ğ•Š Â·: sâ‰¡'b'â¥ŠËœâ‰ g}
  Bull  â† {gâ€¿s ğ•Š ğ•©: (+Â´'b'=s)=(+Â´gâŠ¸=)Ë˜ğ•©}
  Bc    â† {gâ€¿s ğ•Š ğ•©: (â‰ s)=+Â´Ë˜ğ•©âˆŠg}
  Prune â† {ğ•¨ Solved ğ•© ? â‰âŠ‘ğ•¨; ğ•©/Ëœğ•¨(Bullâˆ§Bc)ğ•©}

  Verifyâ‡{ğ•¨ ğ•Š uâ€¿x: ğ•¨â‰¡âŠ‘Â¨(<(â‰ â‹ˆâŠ¢)Univ u){lâ€¿w ğ•Š gâ€¿s: (â‰ â‹ˆâŠ¢)gâ€¿s Prune w}`x}
  Playâ‡{
    Cow ğ•©:
    â€¢Out "Computer Guess: "âˆ¾â€¢Fmt gâ†Guess ğ•©
    â€¢Out "Enter Bulls and Cows: "
    sâ†â€¢GetLine@
    prâ†gâ€¿s Prune ğ•©
    {
      0=â‰ pr ? "";
      1=â‰ pr ? â€¢Out "One choice left, it must be "âˆ¾â€¢Fmt âŠpr;
      â€¢Out (â€¢Fmt â‰ pr)âˆ¾" choices left", Cow pr
    }
    pr
  } Univ
}
! 480â€¿126â€¿23â€¿1 moo.Verify âŸ¨
  4â¥Š10
  âŸ¨
    âŸ¨6â€¿5â€¿4â€¿0, "b" âŸ©
    âŸ¨7â€¿3â€¿4â€¿1, "c" âŸ©
    âŸ¨9â€¿5â€¿2â€¿7, "cc"âŸ©
    âŸ¨6â€¿9â€¿1â€¿2, "cc"âŸ©
  âŸ©
âŸ©
# moo.Play 4â¥Š10 # Enjoy the game!

# 28
Odometer â† {ğ•©(BConvâŸœâŠ‘)â‰1â€¿0â†•Ã—Â´ğ•©}
Odometer1 â† {>â¥Šâˆ¾âŒœÂ´â†•Â¨ğ•©}
Odometer2 â† {â‰>(Ã—Â´ğ•©)â¥ŠÂ¨(âŒ½Ã—`âŒ½1â†“ğ•©âˆ¾1)/Â¨â†•Â¨ğ•©}
Odometer3 â† {ğ•©|â‰1âŒŠ(â†•Ã—Â´ğ•©)Ã·âŒœâŒ½Ã—`âŒ½1â†“ğ•©âˆ¾1}
Successor â† {ğ•¨âŠ¸{(ğ•¨|ğ•©)+1â†“(ğ•¨=ğ•©)âˆ¾0}_fix ğ•©+(-â‰ ğ•©)â†‘1}
Odometer4a â† {>ğ•© SuccessorâŸ(â†•Ã—Â´ğ•©)0Ã—ğ•©} # omitted 4 as we have non scalar repeat (âŸ)
Odometer5 â† â‰âˆ˜>Ã—Â´â¥ŠÂ¨(1Â«Ã—`âŒ¾âŒ½)/âŸœâ†•Â¨âŠ¢ # A BQN-oriented one for good measure
Pco2 â† {â‰>(âŠ‘â‹ˆâ‰ )Â¨âŠâŠ¸âŠ”2âŠ¸{ğ•©=1 ? âŸ¨âŸ©; 0=ğ•¨|ğ•© ? ğ•¨âˆ¾ğ•¨ğ•Šğ•©Ã·ğ•¨; (ğ•¨+1)ğ•Šğ•©}ğ•©}
Divisorsâ†{pâ€¿eâ†<Ë˜Pco2 ğ•©, p Ã—Â´âˆ˜â‹†â‰1 Odometer 1+e}
! 1 = â‰ â·âŸ¨Odometer, Odometer1, Odometer2, Odometer3, Odometer4aâŸ© {ğ•ğ•©}Â¨<4â€¿2â€¿3
! 1â€¿5â€¿2â€¿10â€¿4â€¿20â€¿8â€¿40â€¿16â€¿80â€¿32â€¿160 â‰¡ Divisors 160

# 29
Indâ†{(â¥Šğ•¨)âŠËœ(<â‰¢ğ•¨)EncÂ¨âˆ¾âŒœÂ´ğ•©}
Ind1â†{(â¥Šğ•¨)âŠËœ+âŒœÂ´ğ•©Ã—âŒ½Ã—`âŒ½1Â«â‰¢ğ•¨}
# Support missing axes since âŠ doesn't. Value âˆ˜ indicates a missing axis.
EIndâ†{bâ†{âˆ˜}â‰¡Â¨ğ•©,ğ•¨ Ind (â†•Â¨b/â‰¢ğ•¨)âŒ¾(bâŠ¸/)ğ•©}
! {
  xâ†RandÂ¨5â€¿7â€¿11â¥Š100
  iâ†RandÂ¨2â€¿3â¥Š5 â‹„ jâ†RandÂ¨6â¥Š7 â‹„ kâ†RandÂ¨4â€¿1â€¿1â¥Š11
  ! (iâ€¿jâ€¿kâŠx) â‰¡ x Ind iâ€¿jâ€¿k
  ! (iâ€¿jâ€¿kâŠx) â‰¡ x Ind1 iâ€¿jâ€¿k
  ! (iâ€¿jâŠx) â‰¡ x EInd iâ€¿jâ€¿âˆ˜
  ! ((â‹ˆi)âŠx)â‰¡ x EInd iâ€¿âˆ˜â€¿âˆ˜
  ! (âŸ¨i,0â¥Š0,kâŸ©âŠx) â‰¡ x EInd âŸ¨i,0â¥Š0,kâŸ©
}

# 30
Transposeâ†{(â¥Šğ•©)âŠËœ(>â¥ŠÂ¨â†•(â‰¢ğ•©)âŒŠËâˆ˜+â‰1â€¿âˆ(âŒˆÂ´â‰¢ğ•©)Ã—Â¬b)+Ëâˆ˜Ã—â‰1â€¿âˆ(â‰¢ğ•©)âŠ¸EncË˜â‰ bâ†ğ•¨=âŒœâ†•0âŒˆ1+âŒˆÂ´ğ•¨}
# Version with infinity does not work (no infinite ranges):
# Transpose1â†{(â¥Šğ•©)âŠËœ(>â¥ŠÂ¨â†•(â‰¢ğ•©)âŒŠËâˆ˜+â‰1â€¿âˆ âˆÃ—Â¬b)+Ëâˆ˜Ã—â‰1â€¿âˆ(â‰¢ğ•©)âŠ¸EncË˜â‰bâ†ğ•¨=âŒœâ†•0âŒˆ1+âŒˆÂ´ğ•¨}
Transpose2â†{ğ•©âŠ‘Ëœ(<<ğ•¨)âŠÂ¨â¥ŠÂ¨â†•âŒŠÂ´Â¨(âŠâˆ§ğ•¨)âŠ”(â‰¢ğ•©)âŠËœâ‹ğ•¨} # Functional Conf 2017, Roger Hui
! {
  yâ† RandÂ¨5â€¿13â€¿19â€¿17â€¿11 â¥Š 100
  xâ† 2â€¿1â€¿2â€¿0â€¿1
  zâ†xâ‰y
  iâ†Rand 17, jâ†Rand 11, kâ†Rand 5
  ! (iâ€¿jâ€¿kâŠ‘z) â‰¡ kâ€¿jâ€¿kâ€¿iâ€¿jâŠ‘y
  ! (xâ‰y) â‰¡ x Transpose y
  ! (xâ‰y) â‰¡ x Transpose2 y
}

# 31
MF â† {>(âŒˆÂ´â‰¢Â¨ğ•©)âŠ¸â†‘Â¨ğ•©} # Merge with fill
Inv  â† {MFÂ¨<Ë˜â‰ğ•©}
Vert â† {â‰><Ë˜âŸ(2â‰¤=)Â¨ğ•©}
! {
  tx â† [
    âŸ¨"John"  , 'M', "USA", 26âŸ©
    âŸ¨"Mary"  , 'F', "UK" , 24âŸ©
    âŸ¨"Monika", 'F', "DE" , 31âŸ©
    âŸ¨"Min"   , 'M', "CN" , 17âŸ©
    âŸ¨"Max"   , 'M', "IT" , 29âŸ©
  ]
  ty â† [
    âŸ¨"Min"   , 'M', "CN" , 17âŸ©
    âŸ¨"Mary"  , 'F', "UK" , 24âŸ©
    âŸ¨"John"  , 'M', "UK" , 26âŸ©
    âŸ¨"Monika", 'F', "DE" , 31âŸ©
    âŸ¨"Mesut" , 'M', "DE" , 24âŸ©
    âŸ¨"Mesut" , 'M', "DE" , 24âŸ©
  ]
  ! 3â€¿1â€¿5â€¿2â€¿5â€¿5 â‰¡ txâŠty
  ! 0â€¿1â€¿2â€¿3â€¿4   â‰¡ âŠtx
  ! 0â€¿1â€¿2â€¿3â€¿4â€¿4 â‰¡ âŠty
  x â† Inv tx
  y â† Inv ty
  ! x â‰¡ Inv Vert x
  ! y â‰¡ Inv Vert y
  ! ((Vert x) âŠ (Vert y)) â‰¡ (â‰>xâŠÂ¨x) âŠ (â‰>xâŠÂ¨y)
}

# 32
_ob â† {ğ”½Â¨(+âŒœÂ´â†•Â¨â‰¢ğ•©)âŠ”ğ•©}
School â† +Â´_ob Ã—âŒœ
Carry â† {(âŠ¢ â†“Ëœ 0=âŠ‘){1â†“+Ë0â€¿Â¯1âŒ½Ë˜0âˆ¾ËœË˜âŒŠ(Ã·âŸœ10â‰10âŠ¸|)ğ•©}_fix 0âˆ¾ğ•©}
Multiply â† {
  # We will emulate complex support here
  # A leading length-2 axis gives real and imaginary parts
  # Â¯1â‹†r is (m.Cosâ‰m.Sin) Ï€ Ã— r
  # Mul does complex multiplication
  Cube     â† {ğ•©â¥ŠËœ2â¥ŠËœ2â‹†â¼â‰ ğ•©}Ë˜
  Roots    â† {mâ†â€¢math â‹„ (m.Cosâ‰m.Sin) Ï€ Ã— â†•âŠ¸Ã· ğ•©}
  Mul      â† -Ëâˆ˜Ã— â‰ +Ëâˆ˜Ã—âŸœâŒ½
  Butterflyâ† {(âŠâ‰1ğ•¨)ğ•ŠâŸ(1<=ğ•¨)(+ËË˜ğ•©)â‰â‰(-=ğ•¨)ğ•¨Mul-ËË˜ğ•©}
  FFT      â† {        â¥ŠË˜ (       Roots 2Ã·Ëœâ‰ âŠğ•©) Butterflyâ—‹Cube ğ•©}
  IFT      â† {(â‰ âŠğ•©)Ã·Ëœ â¥ŠË˜ (-âŒ¾(1âŠ¸âŠ)Roots 2Ã·Ëœâ‰ âŠğ•©) Butterflyâ—‹Cube ğ•©}
  m â† âŒˆâŒ¾(2â‹†â¼âŠ¢) Â¯1+ğ•¨+â—‹â‰ ğ•©
  âŠ ğ•¨ MulâŒ¾{ğ•Šâ¼:IFTğ•©;FFTğ•©}â—‹(2â€¿mâŠ¸â†‘) ğ•©
}
! {
  m â† 4â€¿6â¥Šâ†•23
  # âŠ¢_ob m
  xâ†3â€¿2â€¿3â€¿9â€¿0â€¿4â€¿2
  yâ†1â€¿9â€¿9â€¿1â€¿4
  res â† 3â€¿29â€¿48â€¿57â€¿122â€¿96â€¿59â€¿90â€¿22â€¿18â€¿8
  ! res â‰¡ +Â´ _ob x Ã—âŒœ y
  ! res â‰¡ x School y
  ! 6â€¿4â€¿5â€¿0â€¿2â€¿2â€¿8â€¿2â€¿3â€¿8â€¿8 â‰¡ Carry +Â´ _ob x Ã—âŒœ y
  [xl,yl] â† 2â€¿128 â€¢rand.Range 10
  ! 1eÂ¯8 > âŒˆÂ´ | (xl Multiply yl) - 256â†‘xl School yl
}

# 33
# It's more consistent to define Base2 taking bits to value, because
# Base2 Binary ğ•© is ğ•© for natural numbers but Binary Base2 ğ•© drops
# leading zeros.
Base2 â† {ğ•Šâ¼ğ•©: Binary ğ•©; 2âŠ¸Ã—âŠ¸+ËœÂ´âŒ½ğ•©}
Josephus â† 1âŠ¸âŒ½âŒ¾(Base2â¼)
! âˆ§Â´ 1 = JosephusÂ¨ 2â‹†â†•10
! âˆ§Â´ 2 = {(1+ğ•©) -â—‹(JosephusÂ¨) ğ•©} 10â‹†1+â†•5
! 7â€¿1â€¿19â€¿5 â‰¡ JosephusÂ¨ 7â€¿16â€¿25â€¿34

# 34
_pow â† {ğ”½Â´ğ”½ËœâŸ(/2|âŒŠâˆ˜Ã·âŸœ2âŸ(â†•1+Â·âŒŠ2â‹†â¼âŠ¢)ğ•©)ğ•¨}
! 847288609443 â‰¡ 3 Ã—_pow 25

# 35
Tcâ†{ğ•Šğ•©: 0ğ•Šğ•©; (âŠ‘ğ•©)=âŠ‘âŒ½ğ•© ? â·ğ•¨ ; (ğ•¨âˆ¾ğ•¨âŠğ•©) ğ•Š ğ•©âŠğ•©}
Tc2â†{/âŠ‘Ë˜ (âŠ¢âˆ¨âˆ¨Ëâˆ˜âˆ§â‰1â€¿âˆËœ)_fix(â†•â‰ ğ•©)=âŒœğ•©}
# Can also use Solve from bqn-libs matrix.bqn in place of SolveLTriËœâ‰
Tc3â†{/ (1â†‘Ëœâ‰ ğ•©) SolveLTriËœâ‰ (=âŒœËœâ†•â‰ ğ•©)-(â†•â‰ ğ•©)=âŒœËœğ•©+ğ•©=âŠ¢Â´ğ•©}
! {
  iâ†â†•19
  bâ†i=âŒœ2+i      # edges are (i,2+i)
  tâ†(âŠ¢âˆ¨âˆ¨Ëâˆ˜âˆ§â‰1â€¿âˆËœ)_fix b  # transitive closure of b
  # â€¢Show bâŠ".âˆ˜"
  # â€¢Show tâŠ".âˆ˜"
  xâ† 1â€¿4â€¿5â€¿5â€¿7â€¿6â€¿9â€¿9â€¿10â€¿12â€¿11â€¿14â€¿14â€¿15â€¿16â€¿18â€¿18â€¿18â€¿20â€¿20â€¿20
  # â€¢Show (â†•â‰ x)â‰x
  resâ†0â€¿1â€¿4â€¿7â€¿9â€¿12â€¿14â€¿16â€¿18â€¿20
  ! res â‰¡ Tc x
  ! (1â†“res) â‰¡ Tc2 x
  ! (Â¯1â†“res) â‰¡ Tc3 x
}

# 36
Fibâ†{1â‰¥ğ•© ? ğ•© ; (ğ•Šğ•©-2)+ğ•Šğ•©-1}
Fib1â†{ğ•Šğ•©: 0â€¿1ğ•Šğ•©; 0=ğ•© ? âŠ‘ğ•¨ ; (1â†“ğ•¨âˆ¾+Â´ğ•¨)ğ•Šğ•©-1}
Fib2â†{âŠ‘+`âˆ˜âŒ½âŸğ•©â†•2}
Fib3â†{âŒŠ0.5+rÃ·Ëœ(2Ã·Ëœ1+râ†âˆš5)â‹†ğ•©}
# Fib4â†{1â€¢math.GCD+âŸœÃ·Â´0âˆ¾ğ•©â¥Š1}  # Once â€¢math.GCD supports fractions
Fib5 â† âŠ‘ â†• +Ëâˆ˜â€¢math.Combâ‰1â€¿âˆ âŒ½âˆ˜â†•
PDXâ†+Ëâˆ˜Ã—â‰1â€¿âˆ
Fib6aâ†{0â€¿1âŠ‘(=âŒœËœâ†•2)PDXÂ´PDXËœâŸ(/âŒ½Binary ğ•©)âˆ¨âŒœËœâ†•2}
Fib7â†{âŒŠrÃ·Ëœ-Â´ğ•©â‹†Ëœ2Ã·Ëœ1+1â€¿Â¯1Ã—râ†5â‹†0.5}
Fib8â†{+Â´ (âˆ¾Â·(â†“âŸœ0â€¿1Â¨)Â¬)âŸğ•© â¥Š0}

! {
  resâ†0â€¿1â€¿1â€¿2â€¿3â€¿5â€¿8â€¿13â€¿21â€¿34
  ! res â‰¡ Fib Â¨â†•10
  ! res â‰¡ Fib1Â¨â†•10
  ! res â‰¡ Fib2Â¨â†•10
  ! res â‰¡ Fib3Â¨â†•10
  ! res â‰¡ Fib5Â¨â†•10
  ! res â‰¡ Fib6aÂ¨â†•10
  ! res â‰¡ Fib7Â¨â†•10
  ! res â‰¡ Fib8Â¨â†•10
}

# 37
Gâ†{(0âŠ¸âˆ¾Ë˜ âˆ¾ 1âŠ¸âˆ¾Ë˜âˆ˜âŒ½)âŸğ•©â†•1â€¿0}
Bâ†{(0âŠ¸âˆ¾Ë˜ âˆ¾ 1âŠ¸âˆ¾Ë˜)âŸğ•©â†•1â€¿0}
! (B 3) â‰¡ â‰ `Ë˜ G 3
! (G 3) â‰¡ â‰ `â¼Ë˜ B 3

# Bonus: for the online JS REPL
# â€¢SetPlot "scatter"
# (B 10) â€¢Plotâ—‹((2âŠ¸Ã—âŠ¸+ËœÂ´âŒ½)Ë˜) G 10

# 38
Hanoi â† {Â¯1â†“(â¥ŠâŠ¢â‰â‰0Ëœâ‰ â¥ŠâŠ‘âŠ‘âŸ¨1â€¿5â€¿2â‹„0â€¿3â€¿4âŸ©Ë™)âŸğ•©â¥Š1}
! 0â€¿1â€¿3â€¿0â€¿4â€¿5â€¿0 â‰¡ Hanoi 3

# 39
Ack â† {
  0 ğ•Š ğ•©: 1+ğ•©;
  ğ•¨ ğ•Š 0: (ğ•¨-1) ğ•Š 1;
  (ğ•¨-1) ğ•Š ğ•¨ ğ•Š ğ•©-1
}
! 9 â‰¡ 2 Ack 3
! 29 â‰¡ 3 Ack 2

# 40
# If _H solves the halting problem (ğ”½ _H ğ•© is 1 iff ğ”½ğ•© halts) then the
# following function causes a paradox.
# Fâ†{ğ•Š _H ğ•© ? ğ•Š ğ•©; âŸ¨âŸ©}

# 41
Cholesky â† {
  1â‰¥â‰ ğ•© ? âˆšğ•© ;
  nâ†â‰ ğ•©
  pâ†âŒˆnÃ·2
  qâ†âŒŠnÃ·2
  xâ†âŸ¨p,pâŸ©â†‘ğ•© â‹„ yâ†âŸ¨p,-qâŸ©â†‘ğ•© â‹„ zâ†âŸ¨-q,-qâŸ©â†‘ğ•©
  l0 â† ğ•Š x
  l1 â† ğ•Š z - (tâ†+â‰ly) +Ëâˆ˜Ã—â‰Â¯1â€¿âˆ ly â† l0 SolveLTri y
  âˆ¾ [l0â€¿(pâ€¿qâ¥Š0), tâ€¿l1]
}
! {
  a â† [
    231â€¿  42â€¿ Â¯63â€¿ 16â€¿ 26
     42â€¿ 199â€¿Â¯127â€¿Â¯68â€¿ 53
    Â¯63â€¿Â¯127â€¿ 245â€¿ 66â€¿Â¯59
     16â€¿ Â¯68â€¿  66â€¿112â€¿Â¯75
     26â€¿  53â€¿ Â¯59â€¿Â¯75â€¿ 75
  ]
  l â† Cholesky a
  ! âˆ§Â´â¥Š 1e8 > a |âˆ˜- l +Ëâˆ˜Ã—â‰Â¯1â€¿âˆ +â‰l
  ! âˆ§Â´â¥Š (0â‰ l) â‰¤ â‰¥âŒœËœâ†•â‰ l
}

# 42
Minors â† {(/Â¨â‰ âŸœ<â†•â‰ ğ•©)(â‰âŠ)â‰0â€¿âˆ ğ•©}â‰2âŸ2
Minors1 â† {ğ•Š mat: >{mat â‰âˆ˜{ğ•©/ËœÂ¬ğ•¨=â†•â‰ ğ•©}Â´ âŒ½ğ•©}Â¨â†•â‰¢ğ•©}
! (Minors â‰¡ Minors1) 3â€¿4â¥Šâ†•12
! (Minors â‰¡ Minors1) 4â€¿4â¥Š'A'+â†•26

# 43
S1 â† {
  ğ•Š 0: â‹ˆ1;
  (0âˆ¾t)+(tâˆ¾0)Ã— ğ•©-1âŠ£tâ†ğ•Š ğ•©-1
}
S2 â† {
  ğ•Š 0: â‹ˆ1;
  (0âˆ¾t)+(tâˆ¾0)Ã—â†•ğ•©+1âŠ£tâ†ğ•Š ğ•©-1
}
! âŸ¨ 0, 6, 11, 6, 1 âŸ© â‰¡ S1 4
! âŸ¨ 0, 1,  7, 6, 1 âŸ© â‰¡ S2 4

# 44
XEA â† {(ğ•¨âˆ¾1â€¿0) {0=âŠ‘ğ•© ? ğ•¨; ğ•© ğ•Š ğ•¨-ğ•©Ã—âŒŠ(âŠ‘ğ•¨)Ã·âŠ‘ğ•©} (ğ•©âˆ¾0â€¿1)}
CRT â† {
  mâ€¿r ğ•Š nâ€¿s:
  gcdâ€¿aâ€¿b â† m XEA n
  lcm â† mÃ—nÃ·gcd
  c â† lcm|gcdÃ·Ëœ(rÃ—bÃ—n)+(sÃ—aÃ—m)
  ! (r=m|c)âˆ§(s=n|c)
  lcmâˆ¾c
}
! 2â€¿Â¯1â€¿1 â‰¡ 4 XEA 6
! 12â€¿9 â‰¡ 4â€¿1 CRT 6â€¿3

# 45
# If you have complex support:
# ! 0 = 1 + â‹†Ï€Ã—0i1

# 46
Sieveâ†{
  4â‰¥ğ•© ? ğ•©â¥Š0â€¿0â€¿1â€¿1;
  ğ•Š n:
  râ†âŒŠâˆšn
  p â† 2â€¿3â€¿5â€¿7â€¿11â€¿13â€¿17â€¿19â€¿23â€¿29â€¿31â€¿37â€¿41â€¿43
  p â†© (1+(Ã—`p)âŠ¸â‹âŒ¾<n-1)â†‘p
  b â† 0âŒ¾(1âŠ¸âŠ‘) 1 {mâ†nâŒŠğ•¨Ã—â‰ ğ•© â‹„ (mâ¥Šğ•©)>mâ¥Šğ•¨â†‘1}Â´ âŒ½p
  {
    râ‰¥qâ†bâŠ¸âŠâŒ¾<1 ?
    b 0Â¨âŒ¾((qâˆ¾qÃ—/bâ†‘ËœâŒˆnÃ·q)âŠ¸âŠ)â†©
    ğ•Š ğ•©âˆ¾q
  ;
    b 1Â¨âŒ¾(ğ•©âŠ¸âŠ)â†©
  }p
}
! 2â€¿3â€¿5â€¿7â€¿11â€¿13â€¿17â€¿19â€¿23â€¿29 â‰¡ /Sieve 30
! 78498 â‰¡ +Â´Sieve 1e6

# 47
Pg â† â€¢rand.Deal{
  d â† ğ•©+ğ•©
  s â† ğ•©Ã—ğ•©
  t â† ğ•©â†‘Ë˜ğ•©â€¿dâ¥Š(Â¬d)â†‘'a'+ğ•©ğ”½26
  p â† â‹(ğ”½s)+sÃ—/+`(Â¯1âŠ¸â‹†Ã—ğ•©-ËœâŒ½)â†•d
  (âŒ½â†•ğ•©) âŒ½âŸœ{1â†“â¥Š' 'â‰Ë˜ğ•©}Ë˜ ğ•©â€¿ğ•©â¥ŠpâŠâ¥Št
}
#â€¢Show PgÂ¨ 4â€¿5â€¿6â€¿7
TestPg â† {nğ•Šp:
  ! (>(Â«âˆ¨Â»)âŸ(â†•n)1(âŠ¢âˆ¾âˆ¾)0â¥ŠËœn-1) â‰¡ ' 'â‰ p
  rows â† (<' 'âŠ¸â‰ âŠ¸/)Ë˜p
  ! âˆ§Â´ (<"") (Â»(âˆ§â‰¡â†•âˆ˜â‰ )âˆ˜âŠ’Â¨âŠ¢) rows
  ! âˆ§Â´âˆŠ Â¯1âŠ‘rows
}
TestPgâŸœPgÂ¨ 4â€¿5â€¿6â€¿7

# 48
Stick â† {
 c â† ğ•© â€¢rand.Range 3         # where the car is hidden
 i â† ğ•© â€¢rand.Range 3         # your initial choice of door
 +Â´c=i                       # number of cars that you win
}
Change â† {
 c â† ğ•© â€¢rand.Range 3                      # where the car is hidden
 i â† ğ•© â€¢rand.Range 3                      # your initial choice of door
 j â† (cÃ—iâ‰ c)+(3|i+1+â€¢rand.RangeÂ¨ğ•©â¥Š2)Ã—i=c  # your changed choice
 +Â´c=j                                    # number of cars that you win
}
#â€¢Show Stickâ€¿Change {ğ•ğ•©}Â¨ 1e6

# 49
# +Â´(1+â†•âˆ)â‹†-s â†â†’ Ã—Â´Ã·1-(â­â†•âˆ)â‹†-s
