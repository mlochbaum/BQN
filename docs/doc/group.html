<head>
  <meta charset="utf-8">
  <link href="../favicon.ico" rel="shortcut icon" type="image/x-icon"/>
  <link href="../style.css" rel="stylesheet"/>
  <title>BQN: Group</title>
</head>
<div class="nav">(<a href="https://github.com/mlochbaum/BQN">github</a>) / <a href="../index.html">BQN</a> / <a href="index.html">doc</a></div>
<h1 id="group"><a class="header" href="#group">Group</a></h1>
<svg viewBox='-344 -121.8 640 226.8'>
  <g text-anchor='middle' font-family='BQN,monospace'>
    <rect class='code' stroke-width='1' rx='12' x='-280' y='-102.2' width='512' height='204.4'/>
    <g font-size='24px' text-anchor='start' fill='currentColor' opacity='0.9'><text x='-256' y='-98'>Group</text></g>
    <g font-size='18px'><text x='-160' y='-64.4'><tspan class='Number'>0</tspan></text><text x='-80' y='-64.4'><tspan class='Number'>Â¯1</tspan></text><text x='0' y='-64.4'><tspan class='Number'>Â¯1</tspan></text><text x='80' y='-64.4'><tspan class='Number'>2</tspan></text><text x='160' y='-64.4'><tspan class='Number'>0</tspan></text><text x='-160' y='-36.4'><tspan class='String'>"zero"</tspan></text><text x='-80' y='-36.4'><tspan class='String'>"one"</tspan></text><text x='0' y='-36.4'><tspan class='String'>"two"</tspan></text><text x='80' y='-36.4'><tspan class='String'>"three"</tspan></text><text x='160' y='-36.4'><tspan class='String'>"four"</tspan></text><text x='-128' y='47.6'><tspan class='String'>"zero"</tspan></text><text x='-48' y='47.6'><tspan class='String'>"four"</tspan></text><text x='128' y='47.6'><tspan class='String'>"three"</tspan></text><text x='-88' y='84'><tspan class='Number'>0</tspan></text><text x='40' y='84'><tspan class='Number'>1</tspan></text><text x='128' y='84'><tspan class='Number'>2</tspan></text></g>
    <g font-size='16px' text-anchor='end'>
      <text x='-224' y='-64.4'><tspan class='Value'>ğ•¨</tspan></text>
      <text x='-224' y='-36.4'><tspan class='Value'>ğ•©</tspan></text>
      <text x='-224' y='47.6'><tspan class='Value'>ğ•¨</tspan><tspan class='Function'>âŠ”</tspan><tspan class='Value'>ğ•©</tspan></text>
    </g>
    <g class='yellow' stroke-width='2'>
      <line x1='-160' x2='-128' y1='-30.8' y2='33.6'/>
      <line x1='160' x2='-48' y1='-30.8' y2='33.6'/>
      <line x1='80' x2='128' y1='-30.8' y2='33.6'/>
    </g>
    <g class='green' stroke-width='1.5' style='fill:none'>
      <path d='M-176 33.6v28h176v-28'/>
      <path d='M24 33.6v28h32v-28'/>
      <path d='M80 33.6v28h96v-28'/>
    </g>
  </g>
</svg>

<p>The dyadic Group function places values into its result based on indices that tell where each should go. It's a little like a backwards version of <a href="select.html">Select</a>, but because any number of indices can point to the same place, result elements are groups, not single values from the argument.</p>
<p>Group replaces the Key operator from J or Dyalog APL, and <a href="https://aplwiki.com/wiki/Partition_representations">many forms of partitioning</a>. It's related to the K function <code><span class='Function'>=</span></code> of the same name, but results in an array rather than a dictionary.</p>
<h2 id="definition"><a class="header" href="#definition">Definition</a></h2>
<p>Group operates on a list of atomic-number <a href="indices.html">indices</a> <code><span class='Value'>ğ•¨</span></code> and an array <code><span class='Value'>ğ•©</span></code>, treated as a list of its <a href="array.html#cells">major cells</a>, to produce a list of groups, each containing some of the cells from <code><span class='Value'>ğ•©</span></code>. The two arguments have the same length, and each cell in <code><span class='Value'>ğ•©</span></code> is paired with the index in <code><span class='Value'>ğ•¨</span></code> at the same position, to indicate which result group should include that cell.</p>
<a class="replLink" title="Open in the REPL" target="_blank" href="https://mlochbaum.github.io/BQN/try.html#code=MOKAvzHigL8y4oC/MOKAvzEg4omNICJhYmNkZSIgICMgQ29ycmVzcG9uZGluZyBpbmRpY2VzIGFuZCB2YWx1ZXMKCjDigL8x4oC/MuKAvzDigL8xIOKKlCAiYWJjZGUiICAjIFZhbHVlcyBncm91cGVkIGJ5IGluZGV4">â†—ï¸</a><pre>    <span class='Number'>0</span><span class='Ligature'>â€¿</span><span class='Number'>1</span><span class='Ligature'>â€¿</span><span class='Number'>2</span><span class='Ligature'>â€¿</span><span class='Number'>0</span><span class='Ligature'>â€¿</span><span class='Number'>1</span> <span class='Function'>â‰</span> <span class='String'>&quot;abcde&quot;</span>  <span class='Comment'># Corresponding indices and values
</span>â”Œâ”€                     
â•µ 0   1   2   0   1    
  'a' 'b' 'c' 'd' 'e'  
                      â”˜

    <span class='Number'>0</span><span class='Ligature'>â€¿</span><span class='Number'>1</span><span class='Ligature'>â€¿</span><span class='Number'>2</span><span class='Ligature'>â€¿</span><span class='Number'>0</span><span class='Ligature'>â€¿</span><span class='Number'>1</span> <span class='Function'>âŠ”</span> <span class='String'>&quot;abcde&quot;</span>  <span class='Comment'># Values grouped by index
</span>âŸ¨ "ad" "be" "c" âŸ©
</pre>
<p>A few extra options can be useful in some circumstances. First, an &quot;index&quot; of <code><span class='Number'>Â¯1</span></code> in <code><span class='Value'>ğ•¨</span></code> indicates that the corresponding cell should be dropped and not appear in the result. Second, <code><span class='Value'>ğ•¨</span></code> is allowed to have an extra element after the end, which gives a minimum length for the result: otherwise, the result will be just long enough to accomodate the highest index in <code><span class='Value'>ğ•¨</span></code> (it might seem like the last element should be treated like an index, making the minimum length one higher, but the length version usually leads to simpler arithmetic).</p>
<a class="replLink" title="Open in the REPL" target="_blank" href="https://mlochbaum.github.io/BQN/try.html#code=MOKAv8KvMeKAvzLigL8y4oC/wq8xIOKKlCAiYWJjZGUiICAjIERyb3AgYiBhbmQgZQoKMOKAvzHigL8y4oC/MuKAvzHigL82IOKKlCAiYWJjZGUiICAjIExlbmd0aC02IHJlc3VsdA==">â†—ï¸</a><pre>    <span class='Number'>0</span><span class='Ligature'>â€¿</span><span class='Number'>Â¯1</span><span class='Ligature'>â€¿</span><span class='Number'>2</span><span class='Ligature'>â€¿</span><span class='Number'>2</span><span class='Ligature'>â€¿</span><span class='Number'>Â¯1</span> <span class='Function'>âŠ”</span> <span class='String'>&quot;abcde&quot;</span>  <span class='Comment'># Drop b and e
</span>âŸ¨ "a" âŸ¨âŸ© "cd" âŸ©

    <span class='Number'>0</span><span class='Ligature'>â€¿</span><span class='Number'>1</span><span class='Ligature'>â€¿</span><span class='Number'>2</span><span class='Ligature'>â€¿</span><span class='Number'>2</span><span class='Ligature'>â€¿</span><span class='Number'>1</span><span class='Ligature'>â€¿</span><span class='Number'>6</span> <span class='Function'>âŠ”</span> <span class='String'>&quot;abcde&quot;</span>  <span class='Comment'># Length-6 result
</span>âŸ¨ "a" "be" "cd" âŸ¨âŸ© âŸ¨âŸ© âŸ¨âŸ© âŸ©
</pre>
<p>A third extension is that <code><span class='Value'>ğ•¨</span></code> doesn't really have to be a list: if not, then it groups <code><span class='Function'>-=</span><span class='Value'>ğ•¨</span></code>-cells of <code><span class='Value'>ğ•©</span></code> instead of just <code><span class='Number'>Â¯1</span></code>-cells. These cells are placed in index order. This extension isn't compatible with the second option from above, because it's usually not possible to add just one extra element to a non-list array. One usage is to group the diagonals of a table. See if you can find how the code below does this.</p>
<a class="replLink" title="Open in the REPL" target="_blank" href="https://mlochbaum.github.io/BQN/try.html#code=4oqiIGEg4oaQICdhJyvipYrin5wo4oaVw5fCtCkz4oC/NQoKKCvijJzCtMK34oaVwqjiiaIp4oq44oqUIGE=">â†—ï¸</a><pre>    <span class='Function'>âŠ¢</span> <span class='Value'>a</span> <span class='Gets'>â†</span> <span class='String'>'a'</span><span class='Function'>+â¥Š</span><span class='Modifier2'>âŸœ</span><span class='Paren'>(</span><span class='Function'>â†•Ã—</span><span class='Modifier'>Â´</span><span class='Paren'>)</span><span class='Number'>3</span><span class='Ligature'>â€¿</span><span class='Number'>5</span>
â”Œâ”€       
â•µ"abcde  
  fghij  
  klmno" 
        â”˜

    <span class='Paren'>(</span><span class='Function'>+</span><span class='Modifier'>âŒœÂ´</span><span class='Nothing'>Â·</span><span class='Function'>â†•</span><span class='Modifier'>Â¨</span><span class='Function'>â‰¢</span><span class='Paren'>)</span><span class='Modifier2'>âŠ¸</span><span class='Function'>âŠ”</span> <span class='Value'>a</span>
âŸ¨ "a" "bf" "cgk" "dhl" "eim" "jn" "o" âŸ©
</pre>
<p>For a concrete example, we might choose to group a list of words by length. Within each group, cells maintain the ordering they had in the list originally.</p>
<a class="replLink" title="Open in the REPL" target="_blank" href="https://mlochbaum.github.io/BQN/try.html#code=cGhyYXNlIOKGkCAiQlFOIuKAvyJ1c2VzIuKAvyJub3RhdGlvbiLigL8iYXMi4oC/ImEi4oC/InRvb2wi4oC/Im9mIuKAvyJ0aG91Z2h0IgriiY3LmCDiiaDCqOKKuOKKlCBwaHJhc2UgICAjIOKJjcuYIHRvIGZvcm1hdCB2ZXJ0aWNhbGx5">â†—ï¸</a><pre>    <span class='Value'>phrase</span> <span class='Gets'>â†</span> <span class='String'>&quot;BQN&quot;</span><span class='Ligature'>â€¿</span><span class='String'>&quot;uses&quot;</span><span class='Ligature'>â€¿</span><span class='String'>&quot;notation&quot;</span><span class='Ligature'>â€¿</span><span class='String'>&quot;as&quot;</span><span class='Ligature'>â€¿</span><span class='String'>&quot;a&quot;</span><span class='Ligature'>â€¿</span><span class='String'>&quot;tool&quot;</span><span class='Ligature'>â€¿</span><span class='String'>&quot;of&quot;</span><span class='Ligature'>â€¿</span><span class='String'>&quot;thought&quot;</span>
    <span class='Function'>â‰</span><span class='Modifier'>Ë˜</span> <span class='Function'>â‰ </span><span class='Modifier'>Â¨</span><span class='Modifier2'>âŠ¸</span><span class='Function'>âŠ”</span> <span class='Value'>phrase</span>   <span class='Comment'># â‰Ë˜ to format vertically
</span>â”Œâ”€                   
â•µ âŸ¨âŸ©                 
  âŸ¨ "a" âŸ©            
  âŸ¨ "as" "of" âŸ©      
  âŸ¨ "BQN" âŸ©          
  âŸ¨ "uses" "tool" âŸ©  
  âŸ¨âŸ©                 
  âŸ¨âŸ©                 
  âŸ¨ "thought" âŸ©      
  âŸ¨ "notation" âŸ©     
                    â”˜
</pre>
<p>(Could we define <code><span class='Value'>phrase</span></code> more easily? See <a href="#partitioning">below</a>.)</p>
<p>If we'd like to ignore words of 0 letters, or more than 5, we can set all word lengths greater than 5 to 0, then reduce the lengths by 1. Two words end up with left argument values of Â¯1 and are omitted from the result.</p>
<a class="replLink" title="Open in the REPL" target="_blank" href="https://mlochbaum.github.io/BQN/try.html#code=cGhyYXNlIOKGkCAiQlFOIuKAvyJ1c2VzIuKAvyJub3RhdGlvbiLigL8iYXMi4oC/ImEi4oC/InRvb2wi4oC/Im9mIuKAvyJ0aG91Z2h0IgoxIC3LnCDiiaTin5w14oq4w5cg4omgwqggcGhyYXNlCgriiY3LmCB7MS3LnOKJpOKfnDXiirjDl+KJoMKo8J2VqX3iirjiipQgcGhyYXNl">â†—ï¸</a><pre>    <span class='Number'>1</span> <span class='Function'>-</span><span class='Modifier'>Ëœ</span> <span class='Function'>â‰¤</span><span class='Modifier2'>âŸœ</span><span class='Number'>5</span><span class='Modifier2'>âŠ¸</span><span class='Function'>Ã—</span> <span class='Function'>â‰ </span><span class='Modifier'>Â¨</span> <span class='Value'>phrase</span>
âŸ¨ 2 3 Â¯1 1 0 3 1 Â¯1 âŸ©

    <span class='Function'>â‰</span><span class='Modifier'>Ë˜</span> <span class='Brace'>{</span><span class='Number'>1</span><span class='Function'>-</span><span class='Modifier'>Ëœ</span><span class='Function'>â‰¤</span><span class='Modifier2'>âŸœ</span><span class='Number'>5</span><span class='Modifier2'>âŠ¸</span><span class='Function'>Ã—â‰ </span><span class='Modifier'>Â¨</span><span class='Value'>ğ•©</span><span class='Brace'>}</span><span class='Modifier2'>âŠ¸</span><span class='Function'>âŠ”</span> <span class='Value'>phrase</span>
â”Œâ”€                   
â•µ âŸ¨ "a" âŸ©            
  âŸ¨ "as" "of" âŸ©      
  âŸ¨ "BQN" âŸ©          
  âŸ¨ "uses" "tool" âŸ©  
                    â”˜
</pre>
<p>Note that the length of the result is determined by the largest index. So the result never includes trailing empty groups. A reader of the above code might expect 5 groups (lengths 1 through 5), but there are no words of length 5, so the last group isn't there. To ensure the result always has 5 groups, we can add a <code><span class='Number'>5</span></code> at the end of the left argument.</p>
<a class="replLink" title="Open in the REPL" target="_blank" href="https://mlochbaum.github.io/BQN/try.html#code=cGhyYXNlIOKGkCAiQlFOIuKAvyJ1c2VzIuKAvyJub3RhdGlvbiLigL8iYXMi4oC/ImEi4oC/InRvb2wi4oC/Im9mIuKAvyJ0aG91Z2h0IgriiY3LmCB7NeKIvsucMS3LnOKJpOKfnDXiirjDl+KJoMKo8J2VqX3iirjiipQgcGhyYXNl">â†—ï¸</a><pre>    <span class='Function'>â‰</span><span class='Modifier'>Ë˜</span> <span class='Brace'>{</span><span class='Number'>5</span><span class='Function'>âˆ¾</span><span class='Modifier'>Ëœ</span><span class='Number'>1</span><span class='Function'>-</span><span class='Modifier'>Ëœ</span><span class='Function'>â‰¤</span><span class='Modifier2'>âŸœ</span><span class='Number'>5</span><span class='Modifier2'>âŠ¸</span><span class='Function'>Ã—â‰ </span><span class='Modifier'>Â¨</span><span class='Value'>ğ•©</span><span class='Brace'>}</span><span class='Modifier2'>âŠ¸</span><span class='Function'>âŠ”</span> <span class='Value'>phrase</span>
â”Œâ”€                   
â•µ âŸ¨ "a" âŸ©            
  âŸ¨ "as" "of" âŸ©      
  âŸ¨ "BQN" âŸ©          
  âŸ¨ "uses" "tool" âŸ©  
  âŸ¨âŸ©                 
                    â”˜
</pre>
<h3 id="group-indices"><a class="header" href="#group-indices">Group Indices</a></h3>
<p>Above, Group has two arguments, and <code><span class='Value'>ğ•¨</span></code> gives the indices and <code><span class='Value'>ğ•©</span></code> is the values to be grouped. In the one-argument case, <code><span class='Value'>ğ•©</span></code> now gives the result indices, and the values grouped are indices related to <code><span class='Value'>ğ•©</span></code>. For a numeric list, <code><span class='Function'>âŠ”</span><span class='Value'>ğ•©</span></code> is <code><span class='Value'>ğ•©</span><span class='Function'>âŠ”â†•â‰ </span><span class='Value'>ğ•©</span></code>.</p>
<a class="replLink" title="Open in the REPL" target="_blank" href="https://mlochbaum.github.io/BQN/try.html#code=4omNy5gg4oqUIDLigL8z4oC/wq8x4oC/Mg==">â†—ï¸</a><pre>    <span class='Function'>â‰</span><span class='Modifier'>Ë˜</span> <span class='Function'>âŠ”</span> <span class='Number'>2</span><span class='Ligature'>â€¿</span><span class='Number'>3</span><span class='Ligature'>â€¿</span><span class='Number'>Â¯1</span><span class='Ligature'>â€¿</span><span class='Number'>2</span>
â”Œâ”€         
â•µ âŸ¨âŸ©       
  âŸ¨âŸ©       
  âŸ¨ 0 3 âŸ©  
  âŸ¨ 1 âŸ©    
          â”˜
</pre>
<p>Here, the index 2 appears at indices 0 and 3 while the index 3 appears at index 1.</p>
<p>But <code><span class='Value'>ğ•©</span></code> can also be a list of numeric arrays. In this case the indices <code><span class='Function'>â†•âˆ¾â‰¢</span><span class='Modifier'>Â¨</span><span class='Value'>ğ•©</span></code> will be grouped by <code><span class='Value'>ğ•©</span></code> according to the multidimensional grouping documented in the next section. Since the argument to <a href="range.html">Range</a> (<code><span class='Function'>â†•</span></code>) is now a list, each index to be grouped is a list instead of a number. As with <code><span class='Function'>â†•</span></code>, the depth of the result of Group Indices is always one greater than that of its argument. One consequence is that for an array <code><span class='Value'>a</span></code> of any rank, <code><span class='Function'>âŠ”â‹ˆ</span><span class='Value'>a</span></code> groups the indices <code><span class='Function'>â†•â‰¢</span><span class='Value'>a</span></code>.</p>
<h3 id="multidimensional-grouping"><a class="header" href="#multidimensional-grouping">Multidimensional grouping</a></h3>
<p>Dyadic Group allows the right argument to be grouped along multiple axes by using a nested left argument. In this case, <code><span class='Value'>ğ•¨</span></code> must be a list of numeric arrays, and the result has rank <code><span class='Function'>â‰ </span><span class='Value'>ğ•¨</span></code>. Assuming for now that all elements of <code><span class='Value'>ğ•¨</span></code> are lists, each result element has the same rank as <code><span class='Value'>ğ•©</span></code>. The result shape is <code><span class='Number'>1</span><span class='Function'>+âŒˆ</span><span class='Modifier'>Â´Â¨</span><span class='Value'>ğ•¨</span></code>, while the shape of element <code><span class='Value'>i</span><span class='Function'>âŠ‘</span><span class='Value'>ğ•¨</span><span class='Function'>âŠ”</span><span class='Value'>ğ•©</span></code> is <code><span class='Value'>i</span><span class='Function'>+</span><span class='Modifier'>Â´</span><span class='Modifier2'>âˆ˜</span><span class='Function'>=</span><span class='Modifier'>Â¨</span><span class='Value'>ğ•¨</span></code>. If every element of <code><span class='Value'>ğ•¨</span></code> is a list in ascending order with no Â¯1s, we have <code><span class='Value'>ğ•©</span><span class='Function'>â‰¡âˆ¾</span><span class='Value'>ğ•¨</span><span class='Function'>âŠ”</span><span class='Value'>ğ•©</span></code>, that is, <a href="join.html#join">Join</a> is the inverse of partitioning.</p>
<p>If there are non-list arrays in <code><span class='Value'>ğ•¨</span></code>, these correspond to multiple axes in <code><span class='Value'>ğ•©</span></code> but only one axis of the result. Each of these groups of axes is treated as a single axis in index order, as though <code><span class='Value'>ğ•©</span></code> were reshaped to convert each into exactly one axis, and <code><span class='Function'>â¥Š</span><span class='Modifier'>Â¨</span></code> were applied to <code><span class='Value'>ğ•¨</span></code>.</p>
<p>Here we split up a rank-2 array into a rank-2 array of rank-2 arrays. Along the first axis we simply separate the first pair and second pair of rowsâ€”a partition. Along the second axis we separate odd from even indices.</p>
<a class="replLink" title="Open in the REPL" target="_blank" href="https://mlochbaum.github.io/BQN/try.html#code=KDEww5fihpU0KSvijJzihpU3Cgrin6gw4oC/MOKAvzHigL8xLDDigL8x4oC/MOKAvzHigL8w4oC/MeKAvzDin6kg4oqUICgxMMOX4oaVNCkr4oyc4oaVNw==">â†—ï¸</a><pre>    <span class='Paren'>(</span><span class='Number'>10</span><span class='Function'>Ã—â†•</span><span class='Number'>4</span><span class='Paren'>)</span><span class='Function'>+</span><span class='Modifier'>âŒœ</span><span class='Function'>â†•</span><span class='Number'>7</span>
â”Œâ”€                      
â•µ  0  1  2  3  4  5  6  
  10 11 12 13 14 15 16  
  20 21 22 23 24 25 26  
  30 31 32 33 34 35 36  
                       â”˜

    <span class='Bracket'>âŸ¨</span><span class='Number'>0</span><span class='Ligature'>â€¿</span><span class='Number'>0</span><span class='Ligature'>â€¿</span><span class='Number'>1</span><span class='Ligature'>â€¿</span><span class='Number'>1</span><span class='Separator'>,</span><span class='Number'>0</span><span class='Ligature'>â€¿</span><span class='Number'>1</span><span class='Ligature'>â€¿</span><span class='Number'>0</span><span class='Ligature'>â€¿</span><span class='Number'>1</span><span class='Ligature'>â€¿</span><span class='Number'>0</span><span class='Ligature'>â€¿</span><span class='Number'>1</span><span class='Ligature'>â€¿</span><span class='Number'>0</span><span class='Bracket'>âŸ©</span> <span class='Function'>âŠ”</span> <span class='Paren'>(</span><span class='Number'>10</span><span class='Function'>Ã—â†•</span><span class='Number'>4</span><span class='Paren'>)</span><span class='Function'>+</span><span class='Modifier'>âŒœ</span><span class='Function'>â†•</span><span class='Number'>7</span>
â”Œâ”€                              
â•µ â”Œâ”€              â”Œâ”€            
  â•µ  0  2  4  6   â•µ  1  3  5    
    10 12 14 16     11 13 15    
                â”˜            â”˜  
  â”Œâ”€              â”Œâ”€            
  â•µ 20 22 24 26   â•µ 21 23 25    
    30 32 34 36     31 33 35    
                â”˜            â”˜  
                               â”˜
</pre>
<p>Each group <code><span class='Value'>i</span><span class='Function'>âŠ‘</span><span class='Value'>ğ•¨</span><span class='Function'>âŠ”</span><span class='Value'>ğ•©</span></code> is composed of the cells <code><span class='Value'>j</span><span class='Function'>&lt;</span><span class='Modifier'>Â¨</span><span class='Modifier2'>âŠ¸</span><span class='Function'>âŠ</span><span class='Value'>ğ•©</span></code> such that <code><span class='Value'>i</span><span class='Function'>â‰¢</span><span class='Value'>j</span><span class='Function'>âŠ‘</span><span class='Modifier'>Â¨</span><span class='Value'>ğ•¨</span></code>. The groups retain their array structure and ordering along each argument axis. Using multidimensional <a href="replicate.html">Replicate</a> we can say that <code><span class='Value'>i</span><span class='Function'>âŠ‘</span><span class='Value'>ğ•¨</span><span class='Function'>âŠ”</span><span class='Value'>ğ•©</span></code> is <code><span class='Paren'>(</span><span class='Value'>i</span><span class='Function'>=</span><span class='Value'>ğ•¨</span><span class='Paren'>)</span><span class='Function'>/</span><span class='Value'>ğ•©</span></code>.</p>
<h2 id="applications"><a class="header" href="#applications">Applications</a></h2>
<p>The most direct application of Group is to group some values according to a known or computed property. If this property isn't a natural number, it can be turned into one using <a href="selfcmp.html#classify">Classify</a> (<code><span class='Function'>âŠ</span></code>), which numbers the unique values in its argument by first occurrence.</p>
<a class="replLink" title="Open in the REPL" target="_blank" href="https://mlochbaum.github.io/BQN/try.html#code=bG4g4oaQICJQaGVscHMi4oC/IkxhdHluaW5hIuKAvyJCasO4cmdlbiLigL8iQW5kcmlhbm92IuKAvyJCasO4cm5kYWxlbiIKY28g4oaQICJVUyIgICAg4oC/IlNVIiAgICAgIOKAvyJOTyIgICAgIOKAvyJTVSIgICAgICAg4oC/Ik5PIgriiY3LmCBjbyDiipDiirjiipQgbG4=">â†—ï¸</a><pre>    <span class='Value'>ln</span> <span class='Gets'>â†</span> <span class='String'>&quot;Phelps&quot;</span><span class='Ligature'>â€¿</span><span class='String'>&quot;Latynina&quot;</span><span class='Ligature'>â€¿</span><span class='String'>&quot;BjÃ¸rgen&quot;</span><span class='Ligature'>â€¿</span><span class='String'>&quot;Andrianov&quot;</span><span class='Ligature'>â€¿</span><span class='String'>&quot;BjÃ¸rndalen&quot;</span>
    <span class='Value'>co</span> <span class='Gets'>â†</span> <span class='String'>&quot;US&quot;</span>    <span class='Ligature'>â€¿</span><span class='String'>&quot;SU&quot;</span>      <span class='Ligature'>â€¿</span><span class='String'>&quot;NO&quot;</span>     <span class='Ligature'>â€¿</span><span class='String'>&quot;SU&quot;</span>       <span class='Ligature'>â€¿</span><span class='String'>&quot;NO&quot;</span>
    <span class='Function'>â‰</span><span class='Modifier'>Ë˜</span> <span class='Value'>co</span> <span class='Function'>âŠ</span><span class='Modifier2'>âŠ¸</span><span class='Function'>âŠ”</span> <span class='Value'>ln</span>
â”Œâ”€                            
â•µ âŸ¨ "Phelps" âŸ©                
  âŸ¨ "Latynina" "Andrianov" âŸ©  
  âŸ¨ "BjÃ¸rgen" "BjÃ¸rndalen" âŸ©  
                             â”˜
</pre>
<p>If we would like a particular index to key correspondence, we can use a fixed left argument to <a href="search.html#index-of">Index Of</a>.</p>
<a class="replLink" title="Open in the REPL" target="_blank" href="https://mlochbaum.github.io/BQN/try.html#code=bG4g4oaQICJQaGVscHMi4oC/IkxhdHluaW5hIuKAvyJCasO4cmdlbiLigL8iQW5kcmlhbm92IuKAvyJCasO4cm5kYWxlbiIKY28g4oaQICJVUyIgICAg4oC/IlNVIiAgICAgIOKAvyJOTyIgICAgIOKAvyJTVSIgICAgICAg4oC/Ik5PIgpjb3VudHJpZXMg4oaQICJJVCLigL8iSlAi4oC/Ik5PIuKAvyJTVSLigL8iVVMiCmNvdW50cmllcyDiiY3LmCBjbyBjb3VudHJpZXPiirjiipDiirjiipQgbG4=">â†—ï¸</a><pre>    <span class='Value'>countries</span> <span class='Gets'>â†</span> <span class='String'>&quot;IT&quot;</span><span class='Ligature'>â€¿</span><span class='String'>&quot;JP&quot;</span><span class='Ligature'>â€¿</span><span class='String'>&quot;NO&quot;</span><span class='Ligature'>â€¿</span><span class='String'>&quot;SU&quot;</span><span class='Ligature'>â€¿</span><span class='String'>&quot;US&quot;</span>
    <span class='Value'>countries</span> <span class='Function'>â‰</span><span class='Modifier'>Ë˜</span> <span class='Value'>co</span> <span class='Value'>countries</span><span class='Modifier2'>âŠ¸</span><span class='Function'>âŠ</span><span class='Modifier2'>âŠ¸</span><span class='Function'>âŠ”</span> <span class='Value'>ln</span>
â”Œâ”€                                 
â•µ "IT" âŸ¨âŸ©                          
  "JP" âŸ¨âŸ©                          
  "NO" âŸ¨ "BjÃ¸rgen" "BjÃ¸rndalen" âŸ©  
  "SU" âŸ¨ "Latynina" "Andrianov" âŸ©  
  "US" âŸ¨ "Phelps" âŸ©                
                                  â”˜
</pre>
<p>However, this solution will fail if there are trailing keys with no values. To force the result to have a particular length you can append that length to the left argument.</p>
<a class="replLink" title="Open in the REPL" target="_blank" href="https://mlochbaum.github.io/BQN/try.html#code=bG4g4oaQICJQaGVscHMi4oC/IkxhdHluaW5hIuKAvyJCasO4cmdlbiLigL8iQW5kcmlhbm92IuKAvyJCasO4cm5kYWxlbiIKY28g4oaQICJVUyIgICAg4oC/IlNVIiAgICAgIOKAvyJOTyIgICAgIOKAvyJTVSIgICAgICAg4oC/Ik5PIgpjb3VudHJpZXMg4oaQICJJVCLigL8iSlAi4oC/Ik5PIuKAvyJTVSLigL8iVVMiCmNvdW50cmllcyDihqkgIklUIuKAvyJKUCLigL8iTk8i4oC/IlNVIuKAvyJVUyLigL8iWlciCmNvdW50cmllcyDiiY3LmCBjbyBjb3VudHJpZXPiirgo4oqQ4oi+4omg4oiY4oqjKeKKuOKKlCBsbg==">â†—ï¸</a><pre>    <span class='Value'>countries</span> <span class='Gets'>â†©</span> <span class='String'>&quot;IT&quot;</span><span class='Ligature'>â€¿</span><span class='String'>&quot;JP&quot;</span><span class='Ligature'>â€¿</span><span class='String'>&quot;NO&quot;</span><span class='Ligature'>â€¿</span><span class='String'>&quot;SU&quot;</span><span class='Ligature'>â€¿</span><span class='String'>&quot;US&quot;</span><span class='Ligature'>â€¿</span><span class='String'>&quot;ZW&quot;</span>
    <span class='Value'>countries</span> <span class='Function'>â‰</span><span class='Modifier'>Ë˜</span> <span class='Value'>co</span> <span class='Value'>countries</span><span class='Modifier2'>âŠ¸</span><span class='Paren'>(</span><span class='Function'>âŠâˆ¾â‰ </span><span class='Modifier2'>âˆ˜</span><span class='Function'>âŠ£</span><span class='Paren'>)</span><span class='Modifier2'>âŠ¸</span><span class='Function'>âŠ”</span> <span class='Value'>ln</span>
â”Œâ”€                                 
â•µ "IT" âŸ¨âŸ©                          
  "JP" âŸ¨âŸ©                          
  "NO" âŸ¨ "BjÃ¸rgen" "BjÃ¸rndalen" âŸ©  
  "SU" âŸ¨ "Latynina" "Andrianov" âŸ©  
  "US" âŸ¨ "Phelps" âŸ©                
  "ZW" âŸ¨âŸ©                          
                                  â”˜
</pre>
<h3 id="partitioning"><a class="header" href="#partitioning">Partitioning</a></h3>
<p>Previous examples have used lists of strings stranded together. Often it's more convenient to write the string with spaces, and split it up as part of the code. In this case, the index corresponding to each word (that is, each letter in the word) is the number of spaces before it. We can get this number of spaces from a Plus-<a href="scan.html">Scan</a> on the boolean list which is 1 at each space.</p>
<a class="replLink" title="Open in the REPL" target="_blank" href="https://mlochbaum.github.io/BQN/try.html#code=JyAnKCtg4oiYPeKKlOKKoikiQlFOIHVzZXMgbm90YXRpb24gYXMgYSB0b29sIG9mIHRob3VnaHQi">â†—ï¸</a><pre>    <span class='String'>' '</span><span class='Paren'>(</span><span class='Function'>+</span><span class='Modifier'>`</span><span class='Modifier2'>âˆ˜</span><span class='Function'>=âŠ”âŠ¢</span><span class='Paren'>)</span><span class='String'>&quot;BQN uses notation as a tool of thought&quot;</span>
âŸ¨ "BQN" " uses" " notation" " as" " a" " tool" " of" " thought" âŸ©
</pre>
<p>To avoid including spaces in the result, we should change the result index at each space to Â¯1. Here is one way to do that:</p>
<a class="replLink" title="Open in the REPL" target="_blank" href="https://mlochbaum.github.io/BQN/try.html#code=JyAnKCjiiqIty5zCrMOXK2Ap4oiYPeKKlOKKoikiQlFOIHVzZXMgbm90YXRpb24gYXMgYSB0b29sIG9mIHRob3VnaHQi">â†—ï¸</a><pre>    <span class='String'>' '</span><span class='Paren'>((</span><span class='Function'>âŠ¢-</span><span class='Modifier'>Ëœ</span><span class='Function'>Â¬Ã—+</span><span class='Modifier'>`</span><span class='Paren'>)</span><span class='Modifier2'>âˆ˜</span><span class='Function'>=âŠ”âŠ¢</span><span class='Paren'>)</span><span class='String'>&quot;BQN uses notation as a tool of thought&quot;</span>
âŸ¨ "BQN" "uses" "notation" "as" "a" "tool" "of" "thought" âŸ©
</pre>
<p>A function with <a href="under.html">Under</a>, such as <code><span class='Brace'>{</span><span class='Number'>Â¯1</span><span class='Modifier'>Â¨</span><span class='Modifier2'>âŒ¾</span><span class='Paren'>(</span><span class='Value'>ğ•©</span><span class='Modifier2'>âŠ¸</span><span class='Function'>/</span><span class='Paren'>)</span><span class='Function'>+</span><span class='Modifier'>`</span><span class='Value'>ğ•©</span><span class='Brace'>}</span></code>, would also work.</p>
<p>In other cases, we might want to split on spaces, so that words are separated by any number of spaces, and extra spaces don't affect the output. Currently our function makes a new word with each space:</p>
<a class="replLink" title="Open in the REPL" target="_blank" href="https://mlochbaum.github.io/BQN/try.html#code=JyAnKCjiiqIty5zCrMOXK2Ap4oiYPeKKlOKKoikiICBzdHJpbmcgd2l0aCAgc3BhY2VzICAgIg==">â†—ï¸</a><pre>    <span class='String'>' '</span><span class='Paren'>((</span><span class='Function'>âŠ¢-</span><span class='Modifier'>Ëœ</span><span class='Function'>Â¬Ã—+</span><span class='Modifier'>`</span><span class='Paren'>)</span><span class='Modifier2'>âˆ˜</span><span class='Function'>=âŠ”âŠ¢</span><span class='Paren'>)</span><span class='String'>&quot;  string with  spaces   &quot;</span>
âŸ¨ âŸ¨âŸ© âŸ¨âŸ© "string" "with" âŸ¨âŸ© "spaces" âŸ©
</pre>
<p>Trailing spaces are ignored because Group with equal-length arguments never produces trailing empty groupsâ€”to intentionally include them you'd replace <code><span class='Function'>=</span></code> with <code><span class='Paren'>(</span><span class='Function'>=âˆ¾</span><span class='Number'>0</span><span class='Modifier'>Ë™</span><span class='Paren'>)</span></code>. But in string processing we probably want to avoid empty words anywhere. To make this happen, we should increase the word index only once per group of spaces. We can do this by applying Plus Scan to a list that is 1 only for a space with no space before it. This list is produced using <a href="shift.html">Shift Before</a> to get a list of previous elements. To treat the first element as though it's before a space (so that leading spaces have no effect rather than creating an initial empty group), we shift in a 1.</p>
<a class="replLink" title="Open in the REPL" target="_blank" href="https://mlochbaum.github.io/BQN/try.html#code=KOKKouKJjTHiirjCuzziiqIpICcgJz0iICBzdHJpbmcgd2l0aCAgc3BhY2VzICAgIiAgIyBBbGwsIHRoZW4gZmlsdGVyZWQsIHNwYWNlcwoK4omN4p+cKOKKoi3LnMKsw5fCtytgMeKKuMK7POKKoiknICc9IiAgc3RyaW5nIHdpdGggIHNwYWNlcyAgICIgICMgTW9yZSBwcm9jZXNzaW5nCgonICcoKOKKoi3LnMKsw5fCtytgMeKKuMK7POKKoiniiJg94oqU4oqiKSIgIHN0cmluZyB3aXRoICBzcGFjZXMgICAiICAjIEZpbmFsIHJlc3VsdAoKJyAnKCjCrC3LnOKKosOXwrcrYMK74oq4PiniiJjiiaDiipTiiqIpIiAgc3RyaW5nIHdpdGggIHNwYWNlcyAgICIgICMgU2xpZ2h0bHkgc2hvcnRlcg==">â†—ï¸</a><pre>    <span class='Paren'>(</span><span class='Function'>âŠ¢â‰</span><span class='Number'>1</span><span class='Modifier2'>âŠ¸</span><span class='Function'>Â»&lt;âŠ¢</span><span class='Paren'>)</span> <span class='String'>' '</span><span class='Function'>=</span><span class='String'>&quot;  string with  spaces   &quot;</span>  <span class='Comment'># All, then filtered, spaces
</span>â”Œâ”€                                                 
â•µ 1 1 0 0 0 0 0 0 1 0 0 0 0 1 1 0 0 0 0 0 0 1 1 1  
  0 0 0 0 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0  
                                                  â”˜

    <span class='Function'>â‰</span><span class='Modifier2'>âŸœ</span><span class='Paren'>(</span><span class='Function'>âŠ¢-</span><span class='Modifier'>Ëœ</span><span class='Function'>Â¬Ã—</span><span class='Nothing'>Â·</span><span class='Function'>+</span><span class='Modifier'>`</span><span class='Number'>1</span><span class='Modifier2'>âŠ¸</span><span class='Function'>Â»&lt;âŠ¢</span><span class='Paren'>)</span><span class='String'>' '</span><span class='Function'>=</span><span class='String'>&quot;  string with  spaces   &quot;</span>  <span class='Comment'># More processing
</span>â”Œâ”€                                                         
â•µ  1  1 0 0 0 0 0 0  1 0 0 0 0  1  1 0 0 0 0 0 0  1  1  1  
  Â¯1 Â¯1 0 0 0 0 0 0 Â¯1 1 1 1 1 Â¯1 Â¯1 2 2 2 2 2 2 Â¯1 Â¯1 Â¯1  
                                                          â”˜

    <span class='String'>' '</span><span class='Paren'>((</span><span class='Function'>âŠ¢-</span><span class='Modifier'>Ëœ</span><span class='Function'>Â¬Ã—</span><span class='Nothing'>Â·</span><span class='Function'>+</span><span class='Modifier'>`</span><span class='Number'>1</span><span class='Modifier2'>âŠ¸</span><span class='Function'>Â»&lt;âŠ¢</span><span class='Paren'>)</span><span class='Modifier2'>âˆ˜</span><span class='Function'>=âŠ”âŠ¢</span><span class='Paren'>)</span><span class='String'>&quot;  string with  spaces   &quot;</span>  <span class='Comment'># Final result
</span>âŸ¨ "string" "with" "spaces" âŸ©

    <span class='String'>' '</span><span class='Paren'>((</span><span class='Function'>Â¬-</span><span class='Modifier'>Ëœ</span><span class='Function'>âŠ¢Ã—</span><span class='Nothing'>Â·</span><span class='Function'>+</span><span class='Modifier'>`</span><span class='Function'>Â»</span><span class='Modifier2'>âŠ¸</span><span class='Function'>&gt;</span><span class='Paren'>)</span><span class='Modifier2'>âˆ˜</span><span class='Function'>â‰ âŠ”âŠ¢</span><span class='Paren'>)</span><span class='String'>&quot;  string with  spaces   &quot;</span>  <span class='Comment'># Slightly shorter
</span>âŸ¨ "string" "with" "spaces" âŸ©
</pre>
<h2 id="group-and-sorting"><a class="header" href="#group-and-sorting">Group and sorting</a></h2>
<p>Group is closely related to the <a href="replicate.html#inverse">inverse of Indices</a>, <code><span class='Function'>/</span><span class='Modifier'>â¼</span></code>. Calling that function on the index argument gives the length of each group:</p>
<a class="replLink" title="Open in the REPL" target="_blank" href="https://mlochbaum.github.io/BQN/try.html#code=4omgwqjiipQgMuKAvzPigL8x4oC/MgoKL+KBvOKIpyAy4oC/M+KAvzHigL8y">â†—ï¸</a><pre>    <span class='Function'>â‰ </span><span class='Modifier'>Â¨</span><span class='Function'>âŠ”</span> <span class='Number'>2</span><span class='Ligature'>â€¿</span><span class='Number'>3</span><span class='Ligature'>â€¿</span><span class='Number'>1</span><span class='Ligature'>â€¿</span><span class='Number'>2</span>
âŸ¨ 0 1 2 1 âŸ©

    <span class='Function'>/</span><span class='Modifier'>â¼</span><span class='Function'>âˆ§</span> <span class='Number'>2</span><span class='Ligature'>â€¿</span><span class='Number'>3</span><span class='Ligature'>â€¿</span><span class='Number'>1</span><span class='Ligature'>â€¿</span><span class='Number'>2</span>
âŸ¨ 0 1 2 1 âŸ©
</pre>
<p>A related fact is that calling Indices on the result lengths of Group sorts all the indices passed to Group (removing any Â¯1s). This is a kind of counting sort.</p>
<a class="replLink" title="Open in the REPL" target="_blank" href="https://mlochbaum.github.io/BQN/try.html#code=L+KJoMKo4oqUIDLigL8z4oC/MeKAv8KvMeKAvzI=">â†—ï¸</a><pre>    <span class='Function'>/â‰ </span><span class='Modifier'>Â¨</span><span class='Function'>âŠ”</span> <span class='Number'>2</span><span class='Ligature'>â€¿</span><span class='Number'>3</span><span class='Ligature'>â€¿</span><span class='Number'>1</span><span class='Ligature'>â€¿</span><span class='Number'>Â¯1</span><span class='Ligature'>â€¿</span><span class='Number'>2</span>
âŸ¨ 1 2 2 3 âŸ©
</pre>
<p>Called dyadically, Group sorts the right argument according to the left and adds some extra structure. If this structure is removed with <a href="join.html#join">Join</a>, Group can be thought of as a kind of sorting.</p>
<a class="replLink" title="Open in the REPL" target="_blank" href="https://mlochbaum.github.io/BQN/try.html#code=4oi+IDLigL8z4oC/MeKAvzIg4oqUICJhYmNkIgoKMuKAvzPigL8x4oC/MiDijYviirjiio8gImFiY2Qi">â†—ï¸</a><pre>    <span class='Function'>âˆ¾</span> <span class='Number'>2</span><span class='Ligature'>â€¿</span><span class='Number'>3</span><span class='Ligature'>â€¿</span><span class='Number'>1</span><span class='Ligature'>â€¿</span><span class='Number'>2</span> <span class='Function'>âŠ”</span> <span class='String'>&quot;abcd&quot;</span>
"cadb"

    <span class='Number'>2</span><span class='Ligature'>â€¿</span><span class='Number'>3</span><span class='Ligature'>â€¿</span><span class='Number'>1</span><span class='Ligature'>â€¿</span><span class='Number'>2</span> <span class='Function'>â‹</span><span class='Modifier2'>âŠ¸</span><span class='Function'>âŠ</span> <span class='String'>&quot;abcd&quot;</span>
"cadb"
</pre>
